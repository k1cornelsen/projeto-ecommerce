Script started on 2024-11-10 19:15:15+00:00 [TERM="xterm" TTY="/dev/pts/1" COLUMNS="107" LINES="33"]
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# ^C[?2004l[?2004h[?2004l
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [H[2J]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 101L, 3117B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;5Henvironment {[5;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[6;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[8;9HK8S_DIR = 'k8s/'[9;9HSQL_DIR = 'sql/'[10;9HSNYK_TOKEN=credentials('SNYK_AUTH')[11;9HDOCKER_HUB=credentials('DOCKER_HUB')
    }[14;5Hstages {[15;9Hstage('Clone Repository') {[16;13Hsteps {[17;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[18;13H}[19;9H}[21;9Hstage('Snyk Docker Image Scan - App') {[22;13Hsteps {[23;17Hscript {[24;21Hsh "snyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium"[25;17H}[26;13H}[27;9H}[29;9Hstage('Snyk Docker Image Scan - Database') {[30;13Hsteps {[31;17Hscript {[32;21Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[33;90H24,24[9CTop[24;24H[?25h[?25l[33;80Hd[24;24H[?25h[?25l[33;81Hd[24;24H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;17H[46m}[m[32;17H}[33;1H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;13H}[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;9H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[32;9Hstage('Build Docker Image - Database') {[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;13Hsteps {[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;17Hdir(SQL_DIR) {[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;21Hscript {[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;17H[46m}[m[32;25Hdocker.withRegistry('https://registry.hub.docker.com', 'docker-hub-credentials') {[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;29Hdocker.build(DOCKER_IMAGE_DB, '--no-cache .').push()[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;25H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[32;21H}[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[32;17H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;13H}[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;9H}[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;9Hstage('Build Docker Image - App') {[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;29H[24;32r[32;1H
[1;33r[32;13Hsteps {[33;90H[K[33;90H24,29[9CTop[24;29H[?25h[?25l[33;80Hd[24;29H[?25h[?25l[33;81Hd[24;29H[33;80H  [24;25H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;29H[K[24;25H[46m}[m[32;17Hscript {[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;21H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;21H[46m}[m[32;21Hdocker.build(DOCKER_IMAGE_APP, '--no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile .')[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;17H}[m[32;17H}[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;13H}[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;9H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[32;9Hstage('Push Docker Image - App') {[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;13Hsteps {[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;17Hscript {[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;21Hdocker.withRegistry('https://registry.hub.docker.com', 'docker-hub-credentials') {[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;17H[46m}[m[32;25Hdocker.image(DOCKER_IMAGE_APP).push()[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;21H}[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;17H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[32;13H}[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[32;9H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;9Hstage('Snyk Security Scan - Project Directory') {[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;13Hsteps {[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;17Hscript {[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;21H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;21H[46m}[m[32;21H// Executa o escaneamento de seguranÃ§a do Snyk no diretÃ³[32;77Hrio do projeto[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;17H}[m[32;21Hsh 'snyk code test . --severity-treshold=medium'[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;17H}[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;13H}[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[32;9H}[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;9Hstage('Deploy to Kubernetes') {[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;13Hsteps {[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;21Hsh """[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[m[23;25H[K[24;17H[46m}[m[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yanl[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;9H[24;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;17H[24;32r[32;1H
[1;33r[32;21H"""[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;17H}[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;13H}[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;9H}[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;5H}[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;25H[24;32r[32;1H
[1;33r[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;5Hpost {[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;25H[24;32r[32;1H
[1;33r[32;9Hsuccess {[33;90H[K[33;90H24,25[9CTop[24;25H[?25h[?25l[33;80Hd[24;25H[?25h[?25l[33;81Hd[24;25H[33;80H  [24;21H[24;32r[32;1H
[1;33r[32;13Hecho 'Deploy realizado com sucesso!'[33;90H[K[33;90H24,21[9CTop[24;21H[?25h[?25l[33;80Hd[24;21H[?25h[?25l[33;81Hd[24;21H[33;80H  [24;17H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;17H}[m[32;9H}[33;90H[K[33;90H24,17[9CTop[24;17H[?25h[?25l[33;80Hd[24;17H[?25h[?25l[33;81Hd[24;17H[33;80H  [24;13H[23;32r[32;1H
[1;33r[23;17Hscript [46m{[24;13H}[m[32;9Hfailure {[33;90H[K[33;90H24,13[9CTop[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[24;9H}[m[32;13Hecho 'A pipeline falhou!'[33;90H[K[33;90H24,9[10CTop[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;5H[23;32r[32;1H
[1;33r[23;9H [7Cscript [46m{
[m    [46m}[m[32;9H}[33;90H[K[33;90H24,5[10CTop[24;5H[?25h[?25l[33;80Hd[24;5H[?25h[?25l[33;81Hd[24;5H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;5H [11Cscript {[32;5H}[33;90H[K[33;90H24,0-1[8CTop[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;5H[24;32r[32;1H
[1;33r[32;1H}[33;90H[K[33;90H24,5[10CTop[24;5H[?25h[?25l[33;80Hd[24;5H[?25h[?25l[33;81Hd[24;5H[33;80H  [24;9H[24;32r[32;1H
[1;33r[33;90H[K[33;90H24,9[10CAll[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,13[9CAll[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[m[23;26H[K[24;9H[46m}[m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,9[10CAll[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;9H [7Cscript {[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,9[10CAll[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;13H[24;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,13[9CAll[24;13H[?25h[?25l[33;80Hd[24;13H[?25h[?25l[33;81Hd[24;13H[33;80H  [24;9H[23;32r[32;1H
[1;33r[23;13H    script [46m{[m[23;25H[K[24;9H[46m}[m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,9[10CAll[24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [24;5H[23;32r[32;1H
[1;33r[23;9H [7Cscript [46m{
[m    [46m}[m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,5[10CAll[24;5H[?25h[?25l[33;80Hd[24;5H[?25h[?25l[33;81Hd[24;5H[33;80H  [24;1H[23;32r[32;1H
[1;33r[23;5H [11Cscript [46m{
}[m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,1[10CAll[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [24;1H[23;24H{[24;1H[K[25;1H[1m[34m~                                                                                                          [m[33;93H0-1[24;1H[?25h[?25l[33;80Hd[24;1H[?25h[?25l[33;81Hd[24;1H[33;80H  [23;17H
[1m[34m~                                                                                                          [m[33;91H3,17 [23;17H[?25h[?25l[33;80Hd[23;17H[?25h[?25l[33;81Hd[23;17H[33;80H  [22;13H
[1m[34m~                                                                                                          [m[33;91H2,13[22;13H[?25h[?25l[33;80Hd[22;13H[?25h[?25l[33;81Hd[22;13H[33;80H  [21;9H
[1m[34m~                                                                                                          [m[33;91H1,9 [21;9H[?25h[?25l[33;80Hd[21;9H[?25h[?25l[33;81Hd[21;9H[33;80H  [20;1H
[1m[34m~                                                                                                          [m[33;91H0,0-1[20;1H[?25h[?25l[33;80Hd[20;1H[?25h[?25l[33;81Hd[20;1H[33;80H  [19;9H[15;35H[46m{[19;9H}[m
[1m[34m~                                                                                                          [m[33;90H19,9  [19;9H[?25h[?25l[33;80Hd[19;9H[?25h[?25l[33;81Hd[19;9H[33;80H  [18;13H[15;35H{[16;19H[46m{[18;13H}[m
[1m[34m~                                                                                                          [m[33;91H8,13[18;13H[?25h[?25l[33;80Hd[18;13H[?25h[?25l[33;81Hd[18;13H[33;80H  [17;17H[16;19H{

[1m[34m~                                                                                                          [m[33;91H7,17[17;17H[?25h[?25l[33;80Hd[17;17H[?25h[?25l[33;81Hd[17;17H[33;80H  [16;13H
[1m[34m~                                                                                                          [m[33;91H6,13[16;13H[?25h[?25l[33;80Hd[16;13H[?25h[?25l[33;81Hd[16;13H[33;80H  [15;9H
[1m[34m~                                                                                                          [m[33;91H5,9 [15;9H[?25h[?25l[33;80Hd[15;9H[?25h[?25l[33;81Hd[15;9H[33;80H  [14;5H
[1m[34m~                                                                                                          [m[33;91H4,5[14;5H[?25h[?25l[33;80Hd[14;5H[?25h[?25l[33;81Hd[14;5H[33;80H  [13;1H
[1m[34m~                                                                                                          [m[33;91H3,0-1[13;1H[?25h[?25l[33;80Hd[13;1H[?25h[?25l[33;81Hd[13;1H[33;80H  [12;5H[4;17H[46m{[12;5H}[m
[1m[34m~                                                                                                          [m[33;91H2,5  [12;5H[?25h[?25l[33;80Hd[12;5H[?25h[?25l[33;81Hd[12;5H[33;80H  [11;9H[4;17H{[12;1H[1m[34m~                                                                                                          [m[33;91H1,2-9[11;9H[?25h[?25l[33;80Hd[11;9H[?25h[?25l[33;81Hd[11;9H[33;80H  [10;9H
[1m[34m~                                                                                                          [m[33;91H0[10;9H[?25h[?25l[33;80Hd[10;9H[?25h[?25l[33;81Hd[10;9H[33;80H  [9;9H
[1m[34m~                                                                                                          [m[33;90H9,9   [9;9H[?25h[?25l[33;80Hd[9;9H[?25h[?25l[33;81Hd[9;9H[33;80H  [8;9H
[1m[34m~                                                                                                          [m[33;90H8[8;9H[?25h[?25l[33;80Hd[8;9H[?25h[?25l[33;81Hd[8;9H[33;80H  [7;9H
[1m[34m~                                                                                                          [m[33;90H7[7;9H[?25h[?25l[33;80Hd[7;9H[?25h[?25l[33;81Hd[7;9H[33;80H  [6;9H
[1m[34m~                                                                                                          [m[33;90H6[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [5;9H
[1m[34m~                                                                                                          [m[33;90H5[5;9H[?25h[?25l[33;80Hd[5;9H[?25h[?25l[33;81Hd[5;9H[33;80H  [4;5H
[1m[34m~                                                                                                          [m[33;90H4,5[4;5H[?25h[?25l[33;80Hd[4;5H[?25h[?25l[33;81Hd[4;5H[33;80H  [3;1H
[1m[34m~                                                                                                          [m[33;90H3,0-1[3;1H[?25h[?25l[33;80Hd[3;1H[?25h[?25l[33;81Hd[3;1H[33;80H  [2;5H
[1m[34m~                                                                                                          [m[33;90H2,5  [2;5H[?25h[?25l[33;80Hd[2;5H[?25h[?25l[33;81Hd[2;5H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1,1[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;80H [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;1H    environment {[4;18H[K[5;1H        DOCKE[5;14H[K[5;14H[?25h[?25lR_REPO = 'k1cornelsenp/projeto-ecommerce'
        DOCKER_IMAGE_[6;22H[K[6;22H[?25h[?25lAPP = "${DOCKER_REPO}:latest"
        DOCKER_IMAGE_DB = "${DOCK[7;34H[K[7;34H[?25h[?25lER_REPO}-db:latest"
        K8S_DIR = 'k8s/'[8;25H[K[9;1H        SQL_DIR = [9;19H[K[9;19H[?25h[?25l'sql/'
        SNYK_TOKEN = credentials('SNYK_AUTH')[10;46H[K[11;1H        DO[11;11H[K[11;11H[?25h[?25lCKER_HUB = credentials('DOCKER_HUB')
    }[12;6H[K[13;1H[K[14;1H    stages {[14;13H[K[15;1H      [15;7H[K[15;7H[?25h[?25l  stage('Clone Repository') {
            steps {[16;20H[K[17;1H             [17;14H[K[17;14H[?25h[?25l   git 'https://github.com/k1cornelsen/projeto-ecommerce.git'
 [18;2H[K[18;2H[?25h[?25l[11C}
        }[19;10H[K[20;1H[K[21;1H        stage('Docker Hub Login') {[21;36H[K[22;1H   [22;4H[K[22;4H[?25h[?25l[9Csteps {
                script {[23;25H[K[24;1H                    s[24;22H[K[24;22H[?25h[?25lh "echo $DOCKER_HUB_PSW | docker login -u $DOCKER_HUB_USR --pas[?25h[?25lsword-stdin"
                }[25;18H[K[26;1H            }[26;14H[K[27;1H        }[27;10H[K[28;1H[K[29;1H       [29;8H[K[29;8H[?25h[?25l stage('Snyk Docker Image Scan - App') {
            steps {[30;20H[K[31;1H  [31;3H[K[31;3H[?25h[?25l[14Cscript {
                    sh """[32;27H[K[1;32r[32;1H
[1;33r[33;11H[1m(paste) --[m[33;90H[K[32;14H[?25h[?25l[11Csnyk auth --auth-type=token $SNYK_TOKEN[32;13H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hsnyk container test ${DOCKER_IMAGE_APP} --severity-[?25h[?25lthreshold=medium    [?25h[?25l[1;32r[1;1H[3M[1;33r[30;21H"""[31;17H}[32;13H}[29C[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Snyk Docker Image Scan - Database') {[32;8H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;13Hsteps {[31;17Hscript {[32;21Hsh "snyk container test ${DOCKER_IMAGE_DB} --sever[?25h[?25lity-threshold=medium"[32;10H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;17H}[31;13H}[32;9H}   [?25h[?25l[1;32r[1;1H[3M[1;33r[31;9Hstage('Build Docker Image - Database') {[32;13Hsteps {     [?25h[?25l[1;32r[1;1H[2M[1;33r[31;17Hdir(SQL_DIR) {[32;21Hscript {[30C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker.build(DOCKER_IMAGE_DB, '--no-cache .')[32;12H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;21H}[31;17H}[32;13H} [?25h[?25l[1;32r[1;1H[4M[1;33r[29;9H}[31;9Hstage('Push Docker Image - Database') {[32;13Hsteps {[?25h[?25l[1;32r[1;1H[2M[1;33r[31;17Hscript {[32;21Hdocker.withRegistry('https://registry.hub.docker.com', 'docker[?25h[?25l-hub-credentials') {[32;43H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker.image(DOCKER_IMAGE_DB).push()    [?25h[?25l[1;32r[1;1H[3M[1;33r[30;21H}[31;17H}[32;13H}[29C[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Build Docker Image - App') {[32;17H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;13Hsteps {[31;17Hscript {[32;21Hdocker.build(DOCKER_IMAGE_APP, '--no-cache -t ${DOCKER_IMAG[?25h[?25lE_APP} -f Dockerfile .')[32;7H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;17H}[31;13H}[32;9H}      [?25h[?25l[1;32r[1;1H[3M[1;33r[31;9Hstage('Push Docker Image - App') {[32;13Hsteps {[14C[?25h[?25l[1;32r[1;1H[2M[1;33r[31;17Hscript {[32;21Hdocker.withRegistry('https://registry.hub.docker.com', 'docker-hub-credentia[?25h[?25lls') {[32;57H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker.image(DOCKER_IMAGE_APP).push()   [?25h[?25l[1;32r[1;1H[4M[1;33r[29;21H}[30;17H}[31;13H}[32;9H}[46C[?25h[?25l[1;32r[1;1H[2M[1;33r[32;9Hstage('Snyk Security Scan - Project Directory') {[32;16H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;13Hsteps {[31;17Hscript {[32;21Hsh 'snyk code test . --severity-threshold=medium'[32;9H[?25h[?25l[1;32r[32;1H
[1;33r[32;17H}[11C[?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Deploy to Kubernetes') {[32;32H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[?25h[?25l[32;36H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21Hsh """[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[32;24H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[32;11H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco[?25h[?25l.yaml[32;58H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[32;38H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[32;28H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[32;14H[?25h[?25l[1;32r[32;1H
[1;33r[32;21H"""   [?25h[?25l[1;32r[1;1H[6M[1;33r[27;17H}[28;13H}[29;9H}
    }[32;5Hpost {[27C[?25h[?25l[1;32r[1;1H[2M[1;33r[31;9Hsuccess {[32;13Hecho 'Deploy realizado com sucesso!'[32;24H[?25h[?25l[33;1H[K[1;32r[1;1H[7M[1;33r[26;9H}[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H119,0-1[7CBot[32;1H[?25h[?25l[33;80H^[[32;1H[33;80H  [32;1H[33;80H^[[32;1H[33;80H  [32;1H[?25h[?25l[33;80H:[32;1H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 119L, 3556B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "Alteracao Jenkinsfileee[K[K 2"
[?2004l[master 13799f3] Alteracao Jenkinsfile 2
 1 file changed, 27 insertions(+), 7 deletions(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git push origin master
[?2004lEnumerating objects: 5, done.
Counting objects:  20% (1/5)Counting objects:  40% (2/5)Counting objects:  60% (3/5)Counting objects:  80% (4/5)Counting objects: 100% (5/5)Counting objects: 100% (5/5), done.
Delta compression using up to 5 threads
Compressing objects:  33% (1/3)Compressing objects:  66% (2/3)Compressing objects: 100% (3/3)Compressing objects: 100% (3/3), done.
Writing objects:  33% (1/3)Writing objects:  66% (2/3)Writing objects: 100% (3/3)Writing objects: 100% (3/3), 580 bytes | 580.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   bb9344f..13799f3  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# dorck[K[K[Kcker login
[?2004lAuthenticating with existing credentials...
WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 119L, 3556B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;17Hscript {
                    sh 'snyk code test . --severity-threshold=medium'[2;70H[K[3;1H                }[3;18H[K[4;13H}[5;9H}[7;9Hstage('Deploy to Kubernetes') {[8;13Hsteps {[9;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[10;21Hsh """[11;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[12;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[13;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[14;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[15;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[16;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[17;21H"""[18;17H}[19;13H}[20;9H}
    }[23;5Hpost {[24;9Hsuccess {[25;13Hecho 'Deploy realizado com sucesso!'[26;9H}[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H119,0-1[7CBot[32;1H[?25h[?25l[33;80Hd[32;1H[?25h[?25l[33;81Hd[32;1H[33;80H  [31;1H
[1m[34m~                                                                                                          [m[33;92H8,1  [31;1H[?25h[?25l[33;80Hd[31;1H[?25h[?25l[33;81Hd[31;1H[33;80H  [30;5H[23;10H[46m{[30;5H}[m
[1m[34m~                                                                                                          [m[33;92H7,5[30;5H[?25h[?25l[33;80Hd[30;5H[?25h[?25l[33;81Hd[30;5H[33;80H  [29;9H[23;10H{[27;17H[46m{[29;9H}[m
[1m[34m~                                                                                                          [m[33;92H6,9[29;9H[?25h[?25l[33;80Hd[29;9H[?25h[?25l[33;81Hd[29;9H[33;80H  [28;13H[27;17H{

[1m[34m~                                                                                                          [m[33;92H5,13[28;13H[?25h[?25l[33;80Hd[28;13H[?25h[?25l[33;81Hd[28;13H[33;80H  [27;9H
[1m[34m~                                                                                                          [m[33;92H4,9 [27;9H[?25h[?25l[33;80Hd[27;9H[?25h[?25l[33;81Hd[27;9H[33;80H  [26;9H[24;17H[46m{[26;9H}[m
[1m[34m~                                                                                                          [m[33;92H3[26;9H[?25h[?25l[33;80Hd[26;9H[?25h[?25l[33;81Hd[26;9H[33;80H  [25;13H[24;17H{

[1m[34m~                                                                                                          [m[33;92H2,13[25;13H[?25h[?25l[33;80Hd[25;13H[?25h[?25l[33;81Hd[25;13H[33;80H  [24;9H
[1m[34m~                                                                                                          [m[33;92H1,9 [24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [23;5H
[1m[34m~                                                                                                          [m[33;92H0,5[23;5H[?25h[?25l[33;80Hd[23;5H[?25h[?25l[33;81Hd[23;5H[33;80H  [22;1H
[1m[34m~                                                                                                          [m[33;91H09,0-1[22;1H[?25h[?25l[33;80Hd[22;1H[?25h[?25l[33;81Hd[22;1H[33;80H  [21;5H
[1m[34m~                                                                                                          [m[33;92H8,5  [21;5H[?25h[?25l[33;80Hd[21;5H[?25h[?25l[33;81Hd[21;5H[33;80H  [20;9H[7;39H[46m{[20;9H}[m
[1m[34m~                                                                                                          [m[33;92H7,9[20;9H[?25h[?25l[33;80Hd[20;9H[?25h[?25l[33;81Hd[20;9H[33;80H  [19;13H[7;39H{[8;19H[46m{[19;13H}[m
[1m[34m~                                                                                                          [m[33;92H6,13[19;13H[?25h[?25l[33;80Hd[19;13H[?25h[?25l[33;81Hd[19;13H[33;80H  [18;17H[8;19H{[9;94H[46m{[18;17H}[m
[1m[34m~                                                                                                          [m[33;92H5,17[18;17H[?25h[?25l[33;80Hd[18;17H[?25h[?25l[33;81Hd[18;17H[33;80H  [17;21H[9;94H{[18;1H[1m[34m~                                                                                                          [m[33;92H4,21[17;21H[?25h[?25l[33;80Hd[17;21H[?25h[?25l[33;81Hd[17;21H[33;80H  [16;25H
[1m[34m~                                                                                                          [m[33;92H3,25[16;25H[?25h[?25l[33;80Hd[16;25H[?25h[?25l[33;81Hd[16;25H[33;80H  [15;25H
[1m[34m~                                                                                                          [m[33;92H2[15;25H[?25h[?25l[33;80Hd[15;25H[?25h[?25l[33;81Hd[15;25H[33;80H  [14;25H
[1m[34m~                                                                                                          [m[33;92H1[14;25H[?25h[?25l[33;80Hd[14;25H[?25h[?25l[33;81Hd[14;25H[33;80H  [13;25H
[1m[34m~                                                                                                          [m[33;92H0[13;25H[?25h[?25l[33;80Hd[13;25H[?25h[?25l[33;81Hd[13;25H[33;80H  [12;25H
[1m[34m~                                                                                                          [m[33;90H99,25 [12;25H[?25h[?25l[33;80Hd[12;25H[?25h[?25l[33;81Hd[12;25H[33;80H  [11;25H
[1m[34m~                                                                                                          [m[33;91H8[11;25H[?25h[?25l[33;80Hd[11;25H[?25h[?25l[33;81Hd[11;25H[33;80H  [10;21H
[1m[34m~                                                                                                          [m[33;91H7,21[10;21H[?25h[?25l[33;80Hd[10;21H[?25h[?25l[33;81Hd[10;21H[33;80H  [9;17H
[1m[34m~                                                                                                          [m[33;91H6,17[9;17H[?25h[?25l[33;80Hd[9;17H[?25h[?25l[33;81Hd[9;17H[33;80H  [8;13H
[1m[34m~                                                                                                          [m[33;91H5,13[8;13H[?25h[?25l[33;80Hd[8;13H[?25h[?25l[33;81Hd[8;13H[33;80H  [7;9H
[1m[34m~                                                                                                          [m[33;91H4,9 [7;9H[?25h[?25l[33;80Hd[7;9H[?25h[?25l[33;81Hd[7;9H[33;80H  [6;1H
[1m[34m~                                                                                                          [m[33;91H3,0-1[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;1H[K[33;90H92,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Security Scan - Project Directory') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H91,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H90,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;24H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H89,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H88,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H87,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H86,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker.image(DOCKER_IMAGE_APP).push()[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H85,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hdocker.withRegistry('https://registry.hub.docker.com', 'docker-hub-credentials') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H84,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H83,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13Hsteps {[2;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H82,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - App') {[3;24H{[4;102H[46m{[6;21H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H81,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[5;102H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H80,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H79,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H78,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H77,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hdocker.build(DOCKER_IMAGE_APP, '--no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile .')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H76,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H75,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H74,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - App') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H73,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H72,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;24H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H71,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H70,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H69,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H68,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker.image(DOCKER_IMAGE_DB).push()[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H67,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hdocker.withRegistry('https://registry.hub.docker.com', 'docker-hub-credentials') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H66,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H65,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13Hsteps {[2;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H64,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - Database') {[3;24H{[4;102H[46m{[6;21H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H63,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[5;102H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H62,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H61,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H60,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H59,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H58,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker.build(DOCKER_IMAGE_DB, '--no-cache .')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H57,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H56,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hdir(SQL_DIR) {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H55,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13Hsteps {[2;30H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H54,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - Database') {[3;30H{[4;28H[46m{[6;21H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H53,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[5;28H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H52,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H51,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H50,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H49,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H48,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H47,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H46,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - Database') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H45,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H44,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;24H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H43,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H42,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H41,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H40,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H39,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;25Hsnyk auth --auth-type=token $SNYK_TOKEN[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H38,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;21Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H37,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;17Hscript [46m{[m[1;25H[K[2;21Hsh """[2;27H[K[3;30Hauth --auth-type=token $SNYK_TOKEN[3;65H[K[4;21H    snyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[5;17H    """[6;13H    [46m}[m[33;91H6,17[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;13Hsteps {[2;24H{[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H35,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - App') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H34,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H33,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H32,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H31,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H30,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsh "echo $DOCKER_HUB_PSW | docker login -u $DOCKER_HUB_USR --password-stdin"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H29,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H28,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H27,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Docker Hub Login') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H26,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;24H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H25,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;24H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H23,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H22,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H21,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Clone Repository') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H20,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hstages {[2;35H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H19,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[3;35H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H18,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;5H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H17,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9HDOCKER_HUB = credentials('DOCKER_HUB')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H16,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HSNYK_TOKEN = credentials('SNYK_AUTH')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H15,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HSQL_DIR = 'sql/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H14,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9HK8S_DIR = 'k8s/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H13,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H12,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H11,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H10,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Henvironment {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H9,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H8,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hagent any[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H7,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;1Hpipeline {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H6,9[11CAll[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [5;9H
[1m[34m~                                                                                                          [m[33;90H5[5;9H[?25h[?25l[33;80Hd[5;9H[?25h[?25l[33;81Hd[5;9H[33;80H  [4;5H
[1m[34m~                                                                                                          [m[33;90H4,5[4;5H[?25h[?25l[33;80Hd[4;5H[?25h[?25l[33;81Hd[4;5H[33;80H  [3;1H
[1m[34m~                                                                                                          [m[33;90H3,0-1[3;1H[?25h[?25l[33;80Hd[3;1H[?25h[?25l[33;81Hd[3;1H[33;80H  [2;5H
[1m[34m~                                                                                                          [m[33;90H2,5  [2;5H[?25h[?25l[33;80Hd[2;5H[?25h[?25l[33;81Hd[2;5H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1,1[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;1H    environment {[4;18H[K[5;1H        DOCKER[5;15H[K[5;15H[?25h[?25l_REPO = 'k1cornelsenp/projeto-ecommerce'
        DOCKER_IMAGE_AP[6;24H[K[6;24H[?25h[?25lP = "${DOCKER_REPO}:latest"
        DOCKER_IMAGE_DB = "${DOCKER[7;36H[K[7;36H[?25h[?25l_REPO}-db:latest"
        K8S_DIR = 'k8s/'[8;25H[K[9;1H        SQL_DIR = 's[9;21H[K[9;21H[?25h[?25lql/'
        SNYK_TOKEN = credentials('SNYK_AUTH')[10;46H[K[11;1H        DOCK[11;13H[K[11;13H[?25h[?25lER_HUB = credentials('DOCKER_HUB')
    }[12;6H[K[13;1H[K[14;1H    stages {[14;13H[K[15;1H        [15;9H[K[15;9H[?25h[?25lstage('Clone Repository') {
            steps {[16;20H[K[17;1H               [17;16H[K[17;16H[?25h[?25l git 'https://github.com/k1cornelsen/projeto-ecommerce.git'
   [18;4H[K[18;4H[?25h[?25l[9C}
        }[19;10H[K[20;1H[K[21;1H        stage('Docker Hub Login Test') {[21;41H[K[22;1H[K[22;1H[?25h[?25l[12Csteps {
                // Imprime a senha completa[23;44H[K[23;44H[?25h[?25l para verificaÃ§Ã£o em ambiente de desenvolvimento
            [24;13H[K[24;13H[?25h[?25l    echo "Senha Docker Hub: ${DOCKER_HUB_PSW}"[25;1H[K[26;1H               [26;16H[K[26;16H[?25h[?25l // Tenta fazer login e verifica sucesso/falha
                [27;17H[K[27;17H[?25h[?25lsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --[?25h[?25lpassword-stdin || exit 1"
            }[28;14H[K[29;1H        }[29;10H[K[30;1H[K[31;1H        stag[31;13H[K[31;13H[?25h[?25le('Snyk Docker Image Scan - App') {
            steps {[32;20H[K[1;32r[32;1H
[1;33r[33;11H[1m(paste) --[m[33;90H[K[32;8H[?25h[?25l[9Csh """[25C[?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsnyk auth --auth-type=token $SNYK_TOKEN[32;51H[?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium     [?25h[?25l[1;32r[1;1H[2M[1;33r[31;17H"""[32;13H}[30C[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Snyk Docker Image Scan - Database') {[32;34H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[32;9H[?25h[?25l[1;32r[32;1H
[1;33r[32;13H}[33C[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Build Docker Image - Database') {[32;10H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;13Hsteps {[31;17Hdir(SQL_DIR) {[32;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[?25h[?25l[32;20H[?25h[?25l[1;32r[1;1H[5M[1;33r[28;17H}[29;13H}[30;9H}[32;9Hstage('Push Docker Image - Database') {[32;15H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-[?25h[?25lcredentials', usernameVariable[32;1H[1m[34m@@@                                                                                                        [1;32r[m[32;1H
[1;33r[31;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[32;1H: 'DOCKER_HUB_USR', passwordVaria[?25h[?25lble: 'DOCKER_HUB_PSW')]) {[32;10H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21Hsh """[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER[?25h[?25l_HUB_USR --password-stdin[32;38H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_DB}   [?25h[?25l[1;32r[1;1H[3M[1;33r[30;21H"""[31;17H}[32;13H}[28C[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Build Docker Image - App') {[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."     [?25h[?25l[1;32r[1;1H[2M[1;33r[31;13H}[32;9H}     [?25h[?25l[1;32r[1;1H[3M[1;33r[31;9Hstage('Push Docker Image - App') {[32;13Hsteps {[38C[?25h[?25l[1;32r[32;1H
[1;33r[32;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable[32;1H[1m[34m@@@                                                                                                        [1;32r[m[32;1H
[1;33r[31;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[32;1H: 'DOCKER_HUB[?25h[?25l_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[32;17H[?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsh """[26C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[32;18H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_APP}[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21H"""[32;17H}   [?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Snyk Security Scan - Project Directory') {     [?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hsh 'snyk code test . --severity-threshold=medium'  [?25h[?25l[1;32r[32;1H
[1;33r[32;13H}[?25h[?25l[1;32r[1;1H[4M[1;33r[29;9H}[31;9Hstage('Deploy to Kubernetes') {[32;13Hsteps {[1;32r[32;1H
[1;33r[32;17HwithCredentials([file(crede[?25h[?25lntialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[32;12H[?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsh """[21C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[32;36H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[32;23H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[32;7H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-s[?25h[?25lvc-banco.yaml[32;50H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[32;40H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml [?25h[?25l[1;32r[1;1H[2M[1;33r[31;21H"""[32;17H}    [?25h[?25l[1;32r[1;1H[6M[1;33r[27;13H}[28;9H}
    }[31;5Hpost {[32;9Hsuccess {[1;32r[1;1H[2M[1;33r[31;13Hecho 'Deploy realizado com sucesso!'
[?25h[?25l[8C}[26C[?25h[?25l[33;1H[K[1;32r[1;1H[6M[1;33r[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H113,0-1[7CBot[32;1H[?25h[?25l[33;80H^[[32;1H[33;80H  [32;1H[33;80H^[[32;1H[33;80H  [32;1H[?25h[?25l[33;80H:[32;1H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 113L, 3798B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "TG[Kese[Kte senha Jenk[K[K[K[KDockerhub"
[?2004l[master fd7389a] Teste senha Dockerhub
 1 file changed, 24 insertions(+), 30 deletions(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git comm[K[K[K[Kpush origin master
[?2004lEnumerating objects: 5, done.
Counting objects:  20% (1/5)Counting objects:  40% (2/5)Counting objects:  60% (3/5)Counting objects:  80% (4/5)Counting objects: 100% (5/5)Counting objects: 100% (5/5), done.
Delta compression using up to 5 threads
Compressing objects:  33% (1/3)Compressing objects:  66% (2/3)Compressing objects: 100% (3/3)Compressing objects: 100% (3/3), done.
Writing objects:  33% (1/3)Writing objects:  66% (2/3)Writing objects: 100% (3/3)Writing objects: 100% (3/3), 732 bytes | 732.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   13799f3..fd7389a  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [H[2J]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi D[KJenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 113L, 3798B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;9Hstage('Snyk Security Scan - Project Directory') {
            steps {[2;20H[K[3;1H                sh 'snyk code test . --severity-threshold=medium'[3;66H[K[4;13H}[5;9H}[7;9Hstage('Deploy to Kubernetes') {[8;13Hsteps {[9;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[10;21Hsh """[11;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[12;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[13;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[14;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[15;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[16;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[17;21H"""[18;17H}[19;13H}[20;9H}
    }[23;5Hpost {[24;9Hsuccess {[25;13Hecho 'Deploy realizado com sucesso!'[26;9H}[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H113,0-1[7CBot[32;1H[?25h[?25l[33;80H~@k[32;1H[33;80H   [31;1H[33;92H2,1  [31;1H[?25h[?25l[33;80H~@k[31;1H[33;80H   [30;1H[33;92H1[30;1H[?25h[?25l[33;80H~@k[30;1H[33;80H   [29;1H[33;92H0[29;1H[?25h[?25l[33;80H~@k[29;1H[33;80H   [28;1H[33;91H09[28;1H[?25h[?25l[33;80H~@k[28;1H[33;80H   [27;1H[33;92H8[27;1H[?25h[?25l[33;80H~@k[27;1H[33;80H   [26;1H[33;92H7[26;1H[?25h[?25l[33;80H~@k[26;1H[33;80H   [25;1H[33;92H6[25;1H[?25h[?25l[33;80H~@k[25;1H[33;80H   [24;1H[33;92H5[24;1H[?25h[?25l[33;80H~@k[24;1H[33;80H   [23;1H[33;92H4[23;1H[?25h[?25l[33;80H~@k[23;1H[33;80H   [22;1H[33;92H3,0-1[22;1H[?25h[?25l[33;80H~@k[22;1H[33;80H   [21;1H[33;92H2,1  [21;1H[?25h[?25l[33;80H~@k[21;1H[33;80H   [20;1H[33;92H1[20;1H[?25h[?25l[33;80H~@k[20;1H[33;80H   [19;1H[33;92H0[19;1H[?25h[?25l[33;80H~@k[19;1H[33;80H   [18;1H[33;90H99,1 [18;1H[?25h[?25l[33;80H~@k[18;1H[33;80H   [17;1H[33;91H8[17;1H[?25h[?25l[33;80H~@k[17;1H[33;80H   [16;1H[33;91H7[16;1H[?25h[?25l[33;80H~@k[16;1H[33;80H   [15;1H[33;91H6[15;1H[?25h[?25l[33;80H~@k[15;1H[33;80H   [14;1H[33;91H5[14;1H[?25h[?25l[33;80H~@k[14;1H[33;80H   [13;1H[33;91H4[13;1H[?25h[?25l[33;80H~@k[13;1H[33;80H   [12;1H[33;91H3[12;1H[?25h[?25l[33;80H~@k[12;1H[33;80H   [11;1H[33;91H2[11;1H[?25h[?25l[33;80H~@k[11;1H[33;80H   [10;1H[33;91H1[10;1H[?25h[?25l[33;80H~@k[10;1H[33;80H   [9;1H[33;91H0[9;1H[?25h[?25l[33;80H~@k[9;1H[33;80H   [8;1H[33;90H89[8;1H[?25h[?25l[33;80H~@k[8;1H[33;80H   [7;1H[33;91H8[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [6;1H[33;91H7,0-1[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;1H[K[33;90H86,1[10C98%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H85,1[10C97%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[33;90H[K[33;90H84,1[10C96%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H}[33;90H[K[33;90H83,1[10C95%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21H"""[33;90H[K[33;90H82,1[10C93%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_APP}[33;90H[K[33;90H81,0-1[8C92%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[33;90H[K[33;90H80,1[10C91%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21Hsh """[33;90H[K[33;90H79,1[10C90%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [7;1H[1;32r[1;1H[2L[1;33r[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[2;1H: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[33;90H[K[33;90H78,1[10C87%[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [6;1H[33;91H7[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H76,1[10C86%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - App') {[33;90H[K[33;90H75,1[10C85%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H74,1[10C84%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[33;90H[K[33;90H73,1[10C81%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[33;90H[K[33;90H72,1[10C80%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H71,1[10C79%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - App') {[33;90H[K[33;90H70,0-1[8C78%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H69,1[10C76%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H68,1[10C75%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[33;90H[K[33;90H67,1[10C74%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H}[33;90H[K[33;90H66,1[10C73%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21H"""[33;90H[K[33;90H65,1[10C71%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_DB}[33;90H[K[33;90H64,0-1[8C70%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[33;90H[K[33;90H63,1[10C69%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21Hsh """[33;90H[K[33;90H62,1[10C68%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [7;1H[1;32r[1;1H[2L[1;33r[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[2;1H: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[33;90H[K[33;90H61,1[10C66%[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [6;1H[33;91H0[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H59,1[10C65%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - Database') {[33;90H[K[33;90H58,1[10C63%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H57,1[10C62%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[33;90H[K[33;90H56,1[10C60%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H}[33;90H[K[33;90H55,1[10C59%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[33;90H[K[33;90H54,1[10C57%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hdir(SQL_DIR) {[33;90H[K[33;90H53,0-1[8C56%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H52,1[10C55%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - Database') {[33;90H[K[33;90H51,1[10C54%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H50,1[10C53%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H49,1[10C51%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[32;1H[1m[34m@@@                                                                                                        [m[33;90H[K[33;90H48,1[10C50%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[33;90H[K[33;90H47,1[10C50%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H46,1[10C48%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - Database') {[33;90H[K[33;90H45,0-1[8C47%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H44,1[10C46%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H43,1[10C45%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[33;90H[K[33;90H42,1[10C43%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H"""[33;90H[K[33;90H41,1[10C42%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[33;90H[K[33;90H40,1[10C41%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;21Hsnyk auth --auth-type=token $SNYK_TOKEN[33;90H[K[33;90H39,0-1[8C40%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hsh """[33;90H[K[33;90H38,1[10C39%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H37,1[10C37%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - App') {[33;90H[K[33;90H36,1[10C36%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H35,1[10C35%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H34,1[10C34%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[33;90H[K[33;90H33,1[10C32%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[33;90H[K[33;90H32,1[10C31%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H// Tenta fazer login e verifica sucesso/falha[33;90H[K[33;90H31,1[10C30%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[32;1H[1m[34m@@@                                                                                                        [m[33;90H[K[33;90H30,0-1[8C29%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hecho "Senha Docker Hub: ${DOCKER_HUB_PSW}"[33;90H[K[33;90H29,1[10C28%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[33;90H[K[33;90H28,1[10C27%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H27,1[10C25%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Docker Hub Login Test') {[33;90H[K[33;90H26,1[10C24%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H25,0-1[8C23%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9H}[33;90H[K[33;90H24,1[10C22%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13H}[33;90H[K[33;90H23,1[10C20%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[33;90H[K[33;90H22,1[10C19%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;13Hsteps {[33;90H[K[33;90H21,1[10C18%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Clone Repository') {[33;90H[K[33;90H20,0-1[8C17%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[1;5Hstages {[33;90H[K[33;90H19,1[10C16%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [6;1H[1;32r[1;1H[L[1;33r[33;90H[K[33;90H18,1[10C14%[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [7;1H[33;91H9[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [8;1H[33;90H20,0-1[8;1H[?25h[?25l[33;80H~@k[8;1H[33;80H   [9;1H[33;91H1,1  [9;1H[?25h[?25l[33;80H~@k[9;1H[33;80H   [10;1H[33;91H2[10;1H[?25h[?25l[33;80H~@k[10;1H[33;80H   [11;1H[33;91H3[11;1H[?25h[?25l[33;80H~@k[11;1H[33;80H   [12;1H[33;91H4[12;1H[?25h[?25l[33;80H~@k[12;1H[33;80H   [12;2H[33;93H2[12;2H[?25h[?25l[33;80H~@k[12;2H[33;80H   [12;3H[33;93H3[12;3H[?25h[?25l[33;80H~@k[12;3H[33;80H   [12;4H[33;93H4[12;4H[?25h[?25l[33;80H~@k[12;4H[33;80H   [12;5H[33;93H5[12;5H[?25h[?25l[33;80H~@k[12;5H[33;80H   [12;6H[33;93H6[12;6H[?25h[?25l[33;80H~@k[12;6H[33;80H   [12;7H[33;93H7[12;7H[?25h[?25l[33;80H~@k[12;7H[33;80H   [12;8H[33;93H8[12;8H[?25h[?25l[33;80H~@k[12;8H[33;80H   [12;9H[33;93H9[12;9H[?25h[?25l[33;80H~@k[12;9H[33;80H   [12;10H[33;93H10[12;10H[?25h[?25l[33;80H~@k[12;10H[33;80H   [12;11H[33;94H1[12;11H[?25h[?25l[33;80H~@k[12;11H[33;80H   [12;12H[33;94H2[12;12H[?25h[?25l[33;80H~@k[12;12H[33;80H   [12;13H[33;94H3[12;13H[?25h[?25l[33;80H~@k[12;13H[33;80H   [12;14H[33;94H4[12;14H[?25h[?25l[33;80H~@k[12;14H[33;80H   [12;15H[33;94H5[12;15H[?25h[?25l[33;80H~@k[12;15H[33;80H   [12;16H[33;94H6[12;16H[?25h[?25l[33;80H~@k[12;16H[33;80H   [12;17H[33;94H7[12;17H[?25h[?25l[33;80H~@k[12;17H[33;80H   [12;18H[33;94H8[12;18H[?25h[?25l[33;80H~@k[12;18H[33;80H   [12;19H[33;94H9[12;19H[?25h[?25l[33;80H~@k[12;19H[33;80H   [12;20H[33;93H20[12;20H[?25h[?25l[33;80H~@k[12;20H[33;80H   [12;21H[33;94H1[12;21H[?25h[?25l[33;80H~@k[12;21H[33;80H   [12;22H[33;94H2[12;22H[?25h[?25l[33;80H~@k[12;22H[33;80H   [12;23H[33;94H3[12;23H[?25h[?25l[33;80H~@k[12;23H[33;80H   [12;24H[33;94H4[12;24H[?25h[?25l[33;80H~@k[12;24H[33;80H   [12;25H[33;94H5[12;25H[?25h[?25l[33;80H~@k[12;25H[33;80H   [12;26H[33;94H6[12;26H[?25h[?25l[33;80H~@k[12;26H[33;80H   [12;27H[33;94H7[12;27H[?25h[?25l[33;80H~@k[12;27H[33;80H   [12;28H[33;94H8[12;28H[?25h[?25l[33;80H~@k[12;28H[33;80H   [12;29H[33;94H9[12;29H[?25h[?25l[33;80H~@k[12;29H[33;80H   [12;30H[33;93H30[12;30H[?25h[?25l[33;80H~@k[12;30H[33;80H   [12;31H[33;94H1[12;31H[?25h[?25l[33;80H~@k[12;31H[33;80H   [12;32H[33;94H2[12;32H[?25h[?25l[33;80H~@k[12;32H[33;80H   [12;33H[33;94H3[12;33H[?25h[?25l[33;80H~@k[12;33H[33;80H   [12;34H[33;94H4[12;34H[?25h[?25l[33;80H~@k[12;34H[33;80H   [12;35H[33;94H5[12;35H[?25h[?25l[33;80H~@k[12;35H[33;80H   [12;36H[33;94H6[12;36H[?25h[?25l[33;80H~@k[12;36H[33;80H   [12;37H[33;94H7[12;37H[?25h[?25l[33;80H~@k[12;37H[33;80H   [12;38H[33;94H8[12;38H[?25h[?25l[33;80H~@k[12;38H[33;80H   [12;39H[33;94H9[12;39H[?25h[?25l[33;80H~@k[12;39H[33;80H   [12;40H[33;93H40[12;40H[?25h[?25l[33;80H~@k[12;40H[33;80H   [12;41H[33;94H1[12;41H[?25h[?25l[33;80H~@k[12;41H[33;80H   [12;42H[46m{[14C}[m[33;94H2[12;42H[?25h[?25l[33;80H~@k[12;42H[33;80H   [12;43H{[14C}[33;94H3[12;43H[?25h[?25l[33;80H~@k[12;43H[33;80H   [12;44H[33;94H4[12;44H[?25h[?25l[33;80H~@k[12;44H[33;80H   [12;45H[33;94H5[12;45H[?25h[?25l[33;80H~@k[12;45H[33;80H   [12;46H[33;94H6[12;46H[?25h[?25l[33;80H~@k[12;46H[33;80H   [12;47H[33;94H7[12;47H[?25h[?25l[33;80H~@k[12;47H[33;80H   [12;48H[33;94H8[12;48H[?25h[?25l[33;80H~@k[12;48H[33;80H   [12;49H[33;94H9[12;49H[?25h[?25l[33;80H~@k[12;49H[33;80H   [12;50H[33;93H50[12;50H[?25h[?25l[33;80H~@k[12;50H[33;80H   [12;51H[33;94H1[12;51H[?25h[?25l[33;80H~@k[12;51H[33;80H   [12;52H[33;94H2[12;52H[?25h[?25l[33;80H~@k[12;52H[33;80H   [12;53H[33;94H3[12;53H[?25h[?25l[33;80H~@k[12;53H[33;80H   [12;54H[33;94H4[12;54H[?25h[?25l[33;80H~@k[12;54H[33;80H   [12;55H[33;94H5[12;55H[?25h[?25l[33;80H~@k[12;55H[33;80H   [12;56H[33;94H6[12;56H[?25h[?25l[33;80H~@k[12;56H[33;80H   [12;57H[12;42H[46m{[14C}[m[33;94H7[12;57H[?25h[?25l[33;80H~@k[12;57H[33;80H   [12;58H[12;42H{[14C}[33;94H8[12;58H[?25h[?25l[33;80Hi[12;58H[33;80H [12;58H[33;1H[1m-- INSERT --[m[33;90H[K[33;90H24,58[9C14%[12;58H[?25h[?25l[12;42H[46m{[14C}[m[33;94H7[12;57H[?25h[?25l[33;94H8[12;58H[?25h[?25l[12;42H{[14C"[12;58H[K[33;94H7[12;57H[?25h[?25l[33;94H6[12;56H[?25h[?25l[33;94H5[12;55H[?25h[?25l[33;94H4[12;54H[?25h[?25l[33;94H3[12;53H[?25h[?25l[33;94H2[12;52H[?25h[?25l[33;94H1[12;51H[?25h[?25l[33;94H0[12;50H[?25h[?25l[33;93H49[12;49H[?25h[?25l[33;94H8[12;48H[?25h[?25l[33;94H7[12;47H[?25h[?25l[33;94H6[12;46H[?25h[?25l[33;94H5[12;45H[?25h[?25l[33;94H4[12;44H[?25h[?25l[46m{[16;13H}[m[33;94H3[12;43H[?25h[?25lDOCKER_HUB_PSW"[12;57H[K[16;13H}[33;94H2[12;42H[?25h[33;1H[K[12;41H[?25l[33;80H^[[12;41H[33;80H  [12;42H[33;90H24,41[9C14%[12;41H[?25h[?25l[33;80H:[12;41H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 113L, 3796B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub"[25Pvi Jenkinsfile git commit -a -m "Teste senha Dockerhub"2"[1P"[18Ppush origin master[7Pvi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 113L, 3796B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;5Henvironment {[5;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[6;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[8;9HK8S_DIR = 'k8s/'[9;9HSQL_DIR = 'sql/'[10;9HSNYK_TOKEN = credentials('SNYK_AUTH')[11;9HDOCKER_HUB = credentials('DOCKER_HUB')
    }[14;5Hstages {[15;9Hstage('Clone Repository') {[16;13Hsteps {[17;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[18;13H}[19;9H}[21;9Hstage('Docker Hub Login Test') {[22;13Hsteps {[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;17Hecho "Senha Docker Hub: $DOCKER_HUB_PSW"[26;17H// Tenta fazer login e verifica sucesso/falha[27;17Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[28;13H}[29;9H}[31;9Hstage('Snyk Docker Image Scan - App') {[32;13Hsteps {[33;90H24,41[9CTop[24;41H[?25h[?25l[33;80H~@k[24;41H[33;80H   [23;41H[33;91H3[23;41H[?25h[?25l[33;80H~@k[23;41H[33;80H   [22;19H[46m{[28;13H}[m[33;91H2,19[22;19H[?25h[?25l[33;80H~@k[22;19H[33;80H   [21;40H[46m{[m[22;19H{[28;13H}[29;9H[46m}[m[33;91H1,40[21;40H[?25h[?25l[33;80H~@k[21;40H[33;80H   [20;1H[21;40H{[29;9H}[33;91H0,0-1[20;1H[?25h[?25l[33;80H~@k[20;1H[33;80H   [19;9H[15;35H[46m{[19;9H}[m[33;90H19,9  [19;9H[?25h[?25l[33;80H~@k[19;9H[33;80H   [18;13H[15;35H{[16;19H[46m{[18;13H}[m[19;9H}[33;91H8,13[18;13H[?25h[?25l[33;80H~@k[18;13H[33;80H   [17;41H[16;19H{[18;13H}[33;91H7,41[17;41H[?25h[?25l[33;80H~@k[17;41H[33;80H   [16;19H[46m{[18;13H}[m[33;91H6,19[16;19H[?25h[?25l[33;80H~@k[16;19H[33;80H   [15;35H[46m{[m[16;19H{[18;13H}[19;9H[46m}[m[33;91H5,35[15;35H[?25h[?25l[33;80H~@k[15;35H[33;80H   [14;12H[15;35H{[19;9H}[33;91H4,12[14;12H[?25h[?25l[33;80H~@k[14;12H[33;80H   [13;1H[33;91H3,0-1[13;1H[?25h[?25l[33;80H~@k[13;1H[33;80H   [12;5H[4;17H[46m{[12;5H}[m[33;91H2,5  [12;5H[?25h[?25l[33;80H~@k[12;5H[33;80H   [11;41H[4;17H{[12;5H}[33;91H1,41[11;41H[?25h[?25l[33;80H~@k[11;41H[33;80H   [10;41H[33;91H0[10;41H[?25h[?25l[33;80H~@k[10;41H[33;80H   [9;24H[33;90H9,24 [9;24H[?25h[?25l[33;80H~@k[9;24H[33;80H   [8;24H[33;90H8[8;24H[?25h[?25l[33;80H~@k[8;24H[33;80H   [7;41H[7;29H[46m{[11C}[m[33;90H7,41[7;41H[?25h[?25l[33;80H~@k[7;41H[33;80H   [6;41H[7;29H{[11C}[33;90H6[6;41H[?25h[?25l[33;80H~@k[6;41H[33;80H   [5;41H[33;90H5[5;41H[?25h[?25l[33;80H~@k[5;41H[33;80H   [4;17H[46m{[12;5H}[m[33;90H4,17[4;17H[?25h[?25l[33;80H~@k[4;17H[33;80H   [3;1H[4;17H{[12;5H}[33;90H3,0-1[3;1H[?25h[?25l[33;80H~@k[3;1H[33;80H   [2;13H[33;90H2,13 [2;13H[?25h[?25l[33;80H~@k[2;13H[33;80H   [1;10H[33;90H1,10[1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [1;10H[?25h[?25l[33;80H~@k[1;10H[33;80H   [2;13H[33;90H2,13[2;13H[?25h[?25l[33;80H~@k[2;13H[33;80H   [3;1H[33;90H3,0-1[3;1H[?25h[?25l[33;80H~@k[3;1H[33;80H   [4;17H[46m{[12;5H}[m[33;90H4,17 [4;17H[?25h[?25l[33;80H~@k[4;17H[33;80H   [5;41H[4;17H{[12;5H}[33;90H5,41[5;41H[?25h[?25l[33;80H~@k[5;41H[33;80H   [6;41H[33;90H6[6;41H[?25h[?25l[33;80H~@k[6;41H[33;80H   [7;41H[7;29H[46m{[11C}[m[33;90H7[7;41H[?25h[?25l[33;80H~@k[7;41H[33;80H   [8;24H[7;29H{[11C}[33;90H8,24[8;24H[?25h[?25l[33;80H~@k[8;24H[33;80H   [9;24H[33;90H9[9;24H[?25h[?25l[33;80H~@k[9;24H[33;80H   [10;41H[33;90H10,41[10;41H[?25h[?25l[33;80H~@k[10;41H[33;80H   [11;41H[33;91H1[11;41H[?25h[?25l[33;80H~@k[11;41H[33;80H   [12;5H[4;17H[46m{[12;5H}[m[33;91H2,5 [12;5H[?25h[?25l[33;80H~@k[12;5H[33;80H   [13;1H[4;17H{[12;5H}[33;91H3,0-1[13;1H[?25h[?25l[33;80H~@k[13;1H[33;80H   [14;12H[33;91H4,12 [14;12H[?25h[?25l[33;80H~@k[14;12H[33;80H   [15;35H[46m{[19;9H}[m[33;91H5,35[15;35H[?25h[?25l[33;80H~@k[15;35H[33;80H   [16;19H[15;35H{[16;19H[46m{[18;13H}[m[19;9H}[33;91H6,19[16;19H[?25h[?25l[33;80H~@k[16;19H[33;80H   [17;41H[16;19H{[18;13H}[33;91H7,41[17;41H[?25h[?25l[33;80H~@k[17;41H[33;80H   [18;13H[16;19H[46m{[18;13H}[m[33;91H8,13[18;13H[?25h[?25l[33;80H~@k[18;13H[33;80H   [19;9H[15;35H[46m{[m[16;19H{[18;13H}[19;9H[46m}[m[33;91H9,9 [19;9H[?25h[?25l[33;80H~@k[19;9H[33;80H   [20;1H[15;35H{[19;9H}[33;90H20,0-1[20;1H[?25h[?25l[33;80H~@k[20;1H[33;80H   [21;40H[46m{[29;9H}[m[33;91H1,40 [21;40H[?25h[?25l[33;80H~@k[21;40H[33;80H   [22;19H[21;40H{[22;19H[46m{[28;13H}[m[29;9H}[33;91H2,19[22;19H[?25h[?25l[33;80H~@k[22;19H[33;80H   [23;41H[22;19H{[28;13H}[33;91H3,41[23;41H[?25h[?25l[33;80H~@k[23;41H[33;80H   [24;41H[33;91H4[24;41H[?25h[?25l[33;80H~@k[24;41H[33;80H   [24;40H[33;94H0[24;40H[?25h[?25l[33;80H~@k[24;40H[33;80H   [24;39H[33;93H39[24;39H[?25h[?25l[33;80H~@k[24;39H[33;80H   [24;38H[33;94H8[24;38H[?25h[?25l[33;80H~@k[24;38H[33;80H   [24;37H[33;94H7[24;37H[?25h[?25l[33;80H~@k[24;37H[33;80H   [24;36H[33;94H6[24;36H[?25h[?25l[33;80H~@k[24;36H[33;80H   [24;35H[33;94H5[24;35H[?25h[?25l[33;80H~@k[24;35H[33;80H   [24;34H[33;94H4[24;34H[?25h[?25l[33;80H~@k[24;34H[33;80H   [24;33H[33;94H3[24;33H[?25h[?25l[33;80H~@k[24;33H[33;80H   [24;32H[33;94H2[24;32H[?25h[?25l[33;80H~@k[24;32H[33;80H   [24;31H[33;94H1[24;31H[?25h[?25l[33;80H~@k[24;31H[33;80H   [24;30H[33;94H0[24;30H[?25h[?25l[33;80H~@k[24;30H[33;80H   [24;29H[33;93H29[24;29H[?25h[?25l[33;80H~@k[24;29H[33;80H   [24;28H[33;94H8[24;28H[?25h[?25l[33;80H~@k[24;28H[33;80H   [24;27H[33;94H7[24;27H[?25h[?25l[33;80H~@k[24;27H[33;80H   [24;26H[33;94H6[24;26H[?25h[?25l[33;80H~@k[24;26H[33;80H   [24;25H[33;94H5[24;25H[?25h[?25l[33;80H~@k[24;25H[33;80H   [24;24H[33;94H4[24;24H[?25h[?25l[33;80H~@k[24;24H[33;80H   [24;23H[33;94H3[24;23H[?25h[?25l[33;80H~@k[24;23H[33;80H   [24;24H[33;94H4[24;24H[?25h[?25l[33;80H~@k[24;24H[33;80H   [24;25H[33;94H5[24;25H[?25h[?25l[33;80H~@k[24;25H[33;80H   [24;26H[33;94H6[24;26H[?25h[?25l[33;80H~@k[24;26H[33;80H   [24;27H[33;94H7[24;27H[?25h[?25l[33;80H~@k[24;27H[33;80H   [24;28H[33;94H8[24;28H[?25h[?25l[33;80H~@k[24;28H[33;80H   [24;29H[33;94H9[24;29H[?25h[?25l[33;80H~@k[24;29H[33;80H   [24;30H[33;93H30[24;30H[?25h[?25l[33;80H~@k[24;30H[33;80H   [24;31H[33;94H1[24;31H[?25h[?25l[33;80H~@k[24;31H[33;80H   [24;32H[33;94H2[24;32H[?25h[?25l[33;80H~@k[24;32H[33;80H   [24;33H[33;94H3[24;33H[?25h[?25l[33;80H~@k[24;33H[33;80H   [24;34H[33;94H4[24;34H[?25h[?25l[33;80H~@k[24;34H[33;80H   [24;35H[33;94H5[24;35H[?25h[?25l[33;80H~@k[24;35H[33;80H   [24;36H[33;94H6[24;36H[?25h[?25l[33;80H~@k[24;36H[33;80H   [24;37H[33;94H7[24;37H[?25h[?25l[33;80H~@k[24;37H[33;80H   [24;38H[33;94H8[24;38H[?25h[?25l[33;80H~@k[24;38H[33;80H   [24;39H[33;94H9[24;39H[?25h[?25l[33;80H~@k[24;39H[33;80H   [24;40H[33;93H40[24;40H[?25h[?25l[33;80H~@k[24;40H[33;80H   [24;41H[33;94H1[24;41H[?25h[?25l[33;80H~@k[24;41H[33;80H   [24;42H[33;94H2[24;42H[?25h[?25l[33;80H~@k[24;42H[33;80H   [24;43H[33;94H3[24;43H[?25h[?25l[33;80H~@k[24;43H[33;80H   [24;44H[33;94H4[24;44H[?25h[?25l[33;80H~@k[24;44H[33;80H   [24;45H[33;94H5[24;45H[?25h[?25l[33;80H~@k[24;45H[33;80H   [24;46H[33;94H6[24;46H[?25h[?25l[33;80H~@k[24;46H[33;80H   [24;47H[33;94H7[24;47H[?25h[?25l[33;80H~@k[24;47H[33;80H   [24;48H[33;94H8[24;48H[?25h[?25l[33;80H~@k[24;48H[33;80H   [24;49H[33;94H9[24;49H[?25h[?25l[33;80H~@k[24;49H[33;80H   [24;50H[33;93H50[24;50H[?25h[?25l[33;80H~@k[24;50H[33;80H   [24;51H[33;94H1[24;51H[?25h[?25l[33;80H~@k[24;51H[33;80H   [24;52H[33;94H2[24;52H[?25h[?25l[33;80H~@k[24;52H[33;80H   [24;53H[33;94H3[24;53H[?25h[?25l[33;80H~@k[24;53H[33;80H   [24;54H[33;94H4[24;54H[?25h[?25l[33;80H~@k[24;54H[33;80H   [24;55H[33;94H5[24;55H[?25h[?25l[33;80H^[[24;55H[33;80H  [24;55H[33;80H^[[24;55H[33;80H  [24;55H[?25h[?25l[33;80H:[24;55H[33;1H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 113L, 3796B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub"[18Ppush origin master[7Pvi Jenkinsfile [Kvi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub"[18Ppush origin master[7Pvi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 113L, 3796B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;5Henvironment {[5;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[6;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[8;9HK8S_DIR = 'k8s/'[9;9HSQL_DIR = 'sql/'[10;9HSNYK_TOKEN = credentials('SNYK_AUTH')[11;9HDOCKER_HUB = credentials('DOCKER_HUB')
    }[14;5Hstages {[15;9Hstage('Clone Repository') {[16;13Hsteps {[17;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[18;13H}[19;9H}[21;9Hstage('Docker Hub Login Test') {[22;13Hsteps {[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;17Hecho "Senha Docker Hub: $DOCKER_HUB_PSW"[26;17H// Tenta fazer login e verifica sucesso/falha[27;17Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[28;13H}[29;9H}[31;9Hstage('Snyk Docker Image Scan - App') {[32;13Hsteps {[33;90H24,55[9CTop[24;55H[?25h[?25l[33;80H~@k[24;55H[33;80H   [23;55H[33;91H3[23;55H[?25h[?25l[33;80H~@k[23;55H[33;80H   [24;55H[33;91H4[24;55H[?25h[?25l[33;80H~@k[24;55H[33;80H   [24;56H[33;94H6[24;56H[?25h[?25l[33;80H~@k[24;56H[33;80H   [24;56H[?25h[?25l[33;80Hi[24;56H[33;80H [24;56H[33;1H[1m-- INSERT --[m[33;13H[K[33;90H24,56[9CTop[24;56H[?25h[?25l[33;94H7[24;57H[?25h[?25l[24;56H[K[33;94H6[24;56H[?25h[?25l'[33;94H7[24;57H[?25h[?25l[33;94H6[24;56H[?25h[?25l[33;94H5[24;55H[?25h[?25l[33;94H4[24;54H[?25h[?25l[33;94H3[24;53H[?25h[?25l[33;94H2[24;52H[?25h[?25l[33;94H1[24;51H[?25h[?25l[33;94H0[24;50H[?25h[?25l[33;93H49[24;49H[?25h[?25l[33;94H8[24;48H[?25h[?25l[33;94H7[24;47H[?25h[?25l[33;94H6[24;46H[?25h[?25l[33;94H5[24;45H[?25h[?25l[33;94H4[24;44H[?25h[?25l[33;94H3[24;43H[?25h[?25l[33;94H2[24;42H[?25h[?25l[33;94H1[24;41H[?25h[?25l[33;94H0[24;40H[?25h[?25l[33;93H39[24;39H[?25h[?25l[33;94H8[24;38H[?25h[?25l[33;94H7[24;37H[?25h[?25l[33;94H6[24;36H[?25h[?25l[33;94H5[24;35H[?25h[?25l[33;94H4[24;34H[?25h[?25l[33;94H3[24;33H[?25h[?25l[33;94H2[24;32H[?25h[?25l[33;94H1[24;31H[?25h[?25l[33;94H0[24;30H[?25h[?25l[33;93H29[24;29H[?25h[?25l[33;94H8[24;28H[?25h[?25l[33;94H7[24;27H[?25h[?25l[33;94H6[24;26H[?25h[?25l[33;94H5[24;25H[?25h[?25l[33;94H4[24;24H[?25h[?25l[33;94H3[24;23H[?25h[?25lSenha Docker Hub: $DOCKER_HUB_PSW'[24;56H[K[33;94H2[24;22H[?25h[?25l'Senha Docker Hub: $DOCKER_HUB_PSW'[33;94H3[24;23H[?25h[?25l[33;94H4[24;24H[?25h[33;1H[K[24;23H[?25l[33;80H^[[24;23H[33;80H  [24;24H[33;90H24,23[9CTop[24;23H[?25h[?25l[33;80H:[24;23H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 113L, 3796B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub"2"
[?2004l[master 8449dda] Teste senha Dockerhub2
 1 file changed, 1 insertion(+), 1 deletion(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "Teste senha Dockerhub2"[26Pvi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub"[18Ppush origin master
[?2004lEnumerating objects: 5, done.
Counting objects:  20% (1/5)Counting objects:  40% (2/5)Counting objects:  60% (3/5)Counting objects:  80% (4/5)Counting objects: 100% (5/5)Counting objects: 100% (5/5), done.
Delta compression using up to 5 threads
Compressing objects:  33% (1/3)Compressing objects:  66% (2/3)Compressing objects: 100% (3/3)Compressing objects: 100% (3/3), done.
Writing objects:  33% (1/3)Writing objects:  66% (2/3)Writing objects: 100% (3/3)Writing objects: 100% (3/3), 339 bytes | 339.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   fd7389a..8449dda  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [K]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi j[KJenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;30r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[30;1H"Jenkinsfile" 113L, 3796B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;5Henvironment {[5;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[6;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[8;9HK8S_DIR = 'k8s/'[9;9HSQL_DIR = 'sql/'[10;9HSNYK_TOKEN = credentials('SNYK_AUTH')[11;9HDOCKER_HUB = credentials('DOCKER_HUB')
    }[14;5Hstages {[15;9Hstage('Clone Repository') {[16;13Hsteps {[17;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[18;13H}[19;9H}[21;9Hstage('Docker Hub Login Test') {[22;13Hsteps {[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;17Hecho 'Senha Docker Hub: $DOCKER_HUB_PSW'[26;17H// Tenta fazer login e verifica sucesso/falha[27;17Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[28;13H}[29;9H}[30;100H24,23[9CTop[24;23H[?25h[?25l[30;90H~@k[24;23H[30;90H   [23;23H[30;101H3[23;23H[?25h[?25l[30;90H~@k[23;23H[30;90H   [22;19H[46m{[28;13H}[m[30;101H2,19[22;19H[?25h[?25l[30;90H~@k[22;19H[30;90H   [21;23H[22;19H{[28;13H}[30;101H1,23[21;23H[?25h[?25l[30;90H~@k[21;23H[30;90H   [20;1H[30;101H0,0-1[20;1H[?25h[?25l[30;90H~@k[20;1H[30;90H   [19;9H[15;35H[46m{[19;9H}[m[30;100H19,9  [19;9H[?25h[?25l[30;90H~@k[19;9H[30;90H   [18;13H[15;35H{[16;19H[46m{[18;13H}[m[19;9H}[30;101H8,13[18;13H[?25h[?25l[30;90H~@k[18;13H[30;90H   [17;23H[16;19H{[18;13H}[30;101H7,2[17;23H[?25h[?25l[30;90H~@k[17;23H[30;90H   [16;19H[46m{[18;13H}[m[30;101H6,19[16;19H[?25h[?25l[30;90H~@k[16;19H[30;90H   [15;23H[16;19H{[18;13H}[30;101H5,23[15;23H[?25h[?25l[30;90H~@k[15;23H[30;90H   [14;12H[30;101H4,12[14;12H[?25h[?25l[30;90H~@k[14;12H[30;90H   [13;1H[30;101H3,0-1[13;1H[?25h[?25l[30;90H~@k[13;1H[30;90H   [12;5H[4;17H[46m{[12;5H}[m[30;101H2,5  [12;5H[?25h[?25l[30;90H~@k[12;5H[30;90H   [11;23H[4;17H{[12;5H}[30;101H1,23[11;23H[?25h[?25l[30;90H~@k[11;23H[30;90H   [10;23H[30;101H0[10;23H[?25h[?25l[30;90H~@k[10;23H[30;90H   [11;23H[30;101H1[11;23H[?25h[?25l[30;90H~@k[11;23H[30;90H   [12;5H[4;17H[46m{[12;5H}[m[30;101H2,5 [12;5H[?25h[?25l[30;90H~@k[12;5H[30;90H   [13;1H[4;17H{[12;5H}[30;101H3,0-1[13;1H[?25h[?25l[30;90H~@k[13;1H[30;90H   [14;12H[30;101H4,12 [14;12H[?25h[?25l[30;90H~@k[14;12H[30;90H   [15;23H[30;101H5,23[15;23H[?25h[?25l[30;90H~@k[15;23H[30;90H   [16;19H[46m{[18;13H}[m[30;101H6,19[16;19H[?25h[?25l[30;90H~@k[16;19H[30;90H   [17;23H[16;19H{[18;13H}[30;101H7,23[17;23H[?25h[?25l[30;90H~@k[17;23H[30;90H   [18;13H[16;19H[46m{[18;13H}[m[30;101H8,1[18;13H[?25h[?25l[30;90H~@k[18;13H[30;90H   [19;9H[15;35H[46m{[m[16;19H{[18;13H}[19;9H[46m}[m[30;101H9,9 [19;9H[?25h[?25l[30;90H~@k[19;9H[30;90H   [20;1H[15;35H{[19;9H}[30;100H20,0-1[20;1H[?25h[?25l[30;90H~@k[20;1H[30;90H   [21;23H[30;101H1,23 [21;23H[?25h[?25l[30;90H~@k[21;23H[30;90H   [22;19H[46m{[28;13H}[m[30;101H2,19[22;19H[?25h[?25l[30;90H~@k[22;19H[30;90H   [23;23H[22;19H{[28;13H}[30;101H3,23[23;23H[?25h[?25l[30;90H~@k[23;23H[30;90H   [24;23H[30;101H4[24;23H[?25h[?25l[30;90H~@k[24;23H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;1H[K[30;100H25,0-1[9C1%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;23H[1;29r[29;1H
[1;30r[29;9Hstage('Snyk Docker Image Scan - App') {[30;100H[K[30;100H26,23[10C2%[24;23H[?25h[?25l[30;90H~@k[24;23H[30;90H   [24;23H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H27,23[10C3%[24;23H[?25h[?25l[30;90H~@k[24;23H[30;90H   [24;13H[1;29r[29;1H
[1;30r[18;19H[46m{[24;13H}[m[29;17Hsh """[30;100H[K[30;100H28,13[10C4%[24;13H[?25h[?25l[30;90H~@k[24;13H[30;90H   [24;9H[1;29r[29;1H
[1;30r[16;40H[46m{[m[17;19H{[23;13H}[24;9H[46m}[m[29;21Hsnyk auth --auth-type=token $SNYK_TOKEN[30;100H[K[30;100H29,9[11C5%[24;9H[?25h[?25l[30;90H~@k[24;9H[30;90H   [23;13H[16;40H{[17;19H[46m{[23;13H}[m[24;9H}[30;101H8,13[23;13H[?25h[?25l[30;90H~@k[23;13H[30;90H   [22;23H[17;19H{[23;13H}[30;101H7,2[22;23H[?25h[?25l[30;90H~@k[22;23H[30;90H   [21;23H[30;101H6[21;23H[?25h[?25l[30;90H~@k[21;23H[30;90H   [20;1H[30;101H5,0-1[20;1H[?25h[?25l[30;90H~@k[20;1H[30;90H   [19;23H[30;101H4,23 [19;23H[?25h[?25l[30;90H~@k[19;23H[30;90H   [19;24H[30;104H4[19;24H[?25h[?25l[30;90H~@k[19;24H[30;90H   [19;25H[30;104H5[19;25H[?25h[?25l[30;90H~@k[19;25H[30;90H   [19;26H[30;104H6[19;26H[?25h[?25l[30;90H~@k[19;26H[30;90H   [19;27H[30;104H7[19;27H[?25h[?25l[30;90H~@k[19;27H[30;90H   [19;28H[30;104H8[19;28H[?25h[?25l[30;90H~@k[19;28H[30;90H   [19;29H[30;104H9[19;29H[?25h[?25l[30;90H~@k[19;29H[30;90H   [19;30H[30;103H30[19;30H[?25h[?25l[30;90H~@k[19;30H[30;90H   [19;31H[30;104H1[19;31H[?25h[?25l[30;90H~@k[19;31H[30;90H   [19;32H[30;104H2[19;32H[?25h[?25l[30;90H~@k[19;32H[30;90H   [19;33H[30;104H3[19;33H[?25h[?25l[30;90H~@k[19;33H[30;90H   [19;34H[30;104H4[19;34H[?25h[?25l[30;90H~@k[19;34H[30;90H   [19;35H[30;104H5[19;35H[?25h[?25l[30;90H~@k[19;35H[30;90H   [19;36H[30;104H6[19;36H[?25h[?25l[30;90H~@k[19;36H[30;90H   [19;37H[30;104H7[19;37H[?25h[?25l[30;90H~@k[19;37H[30;90H   [19;38H[30;104H8[19;38H[?25h[?25l[30;90H~@k[19;38H[30;90H   [19;39H[30;104H9[19;39H[?25h[?25l[30;90H~@k[19;39H[30;90H   [19;40H[30;103H40[19;40H[?25h[?25l[30;90H~@k[19;40H[30;90H   [19;41H[30;104H1[19;41H[?25h[?25l[30;90Hi[19;41H[30;90H [19;41H[30;1H[1m-- INSERT --[m[30;100H[K[30;100H24,41[10C5%[19;41H[?25h[?25l[30;104H2[19;42H[?25h[?25l[46m{[mDOCKER_HUB_PSW'[23;13H[46m}[m[30;104H3[19;43H[?25h[?25l{[23;13H}[30;104H4[19;44H[?25h[?25l[30;104H5[19;45H[?25h[?25l[30;104H6[19;46H[?25h[?25l[30;104H7[19;47H[?25h[?25l[30;104H8[19;48H[?25h[?25l[30;104H9[19;49H[?25h[?25l[30;103H50[19;50H[?25h[?25l[30;104H1[19;51H[?25h[?25l[30;104H2[19;52H[?25h[?25l[30;104H3[19;53H[?25h[?25l[30;104H4[19;54H[?25h[?25l[30;104H5[19;55H[?25h[?25l[30;104H6[19;56H[?25h[?25l[30;104H7[19;57H[?25h[?25l[19;42H[46m{[14C}[m'[30;104H8[19;58H[?25h[30;1H[K[19;57H[?25l[30;90H^[[19;57H[30;90H  [19;58H[30;100H24,57[10C5%[19;57H[?25h[?25l[30;90H:[19;57H[30;90H[K[30;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 113L, 3798B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub2"[C[1P"3"
[?2004l[master 97e4070] Teste senha Dockerhub3
 1 file changed, 1 insertion(+), 1 deletion(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "Teste senha Dockerhub3"[26Pvi Jenkinsfile git push origin mastercommit -a -m "Teste senha Dockerhub2"[19Ppush origin master
[?2004lEnumerating objects: 5, done.
Counting objects:  20% (1/5)Counting objects:  40% (2/5)Counting objects:  60% (3/5)Counting objects:  80% (4/5)Counting objects: 100% (5/5)Counting objects: 100% (5/5), done.
Delta compression using up to 5 threads
Compressing objects:  33% (1/3)Compressing objects:  66% (2/3)Compressing objects: 100% (3/3)Compressing objects: 100% (3/3), done.
Writing objects:  33% (1/3)Writing objects:  66% (2/3)Writing objects: 100% (3/3)Writing objects: 100% (3/3), 313 bytes | 313.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   8449dda..97e4070  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;30r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[30;1H"Jenkinsfile" 113L, 3798B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;5Henvironment {[5;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[6;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[8;9HK8S_DIR = 'k8s/'[9;9HSQL_DIR = 'sql/'[10;9HSNYK_TOKEN = credentials('SNYK_AUTH')[11;9HDOCKER_HUB = credentials('DOCKER_HUB')
    }[14;5Hstages {[15;9Hstage('Clone Repository') {[16;13Hsteps {[17;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[18;13H}[19;9H}[21;9Hstage('Docker Hub Login Test') {[22;13Hsteps {[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;17Hecho 'Senha Docker Hub: $[46m{[mDOCKER_HUB_PSW[46m}[m'[26;17H// Tenta fazer login e verifica sucesso/falha[27;17Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[28;13H}[29;9H}[30;100H24,57[9CTop[24;57H[?25h[?25l[30;90Hd[24;57H[?25h[?25l[30;91Hd[24;57H[30;90H  [24;1H[24;29r[29;1H
[1;30r[30;1H[K[30;100H24,0-1[8CTop[24;1H[?25h[?25l[30;90Hd[24;1H[?25h[?25l[30;91Hd[24;1H[30;90H  [24;17H[24;29r[29;1H
[1;30r[29;9Hstage('Snyk Docker Image Scan - App') {[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;17H[24;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;13H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;92H[K[24;13H[46m}[m[29;17Hsh """[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;9H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;9H[46m}[m[29;21Hsnyk auth --auth-type=token $SNYK_TOKEN[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;1H[22;29r[29;1H
[1;30r[22;13Hsteps {[22;20H[K[23;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[30;100H[K[30;100H24,0-1[8CTop[24;1H[?25h[?25l[30;90Hd[24;1H[?25h[?25l[30;91Hd[24;1H[30;90H  [24;9H[24;29r[29;1H
[1;30r[29;17H"""[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;13H[24;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;17H[24;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;21H[24;29r[29;1H
[1;30r[30;100H[K[30;100H24,21[9CTop[24;21H[?25h[?25l[30;90Hd[24;21H[?25h[?25l[30;91Hd[24;21H[30;90H  [24;21H[24;29r[29;1H
[1;30r[29;9Hstage('Snyk Docker Image Scan - Database') {[30;100H[K[30;100H24,21[9CTop[24;21H[?25h[?25l[30;90Hd[24;21H[?25h[?25l[30;91Hd[24;21H[30;90H  [24;17H[24;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;13H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;13H[46m}[m[29;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;9H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;9H[46m}[m[29;13H}[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;1H[22;29r[29;1H
[1;30r[22;13Hsteps {[22;20H[K[23;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;9H}[30;100H[K[30;100H24,0-1[8CTop[24;1H[?25h[?25l[30;90Hd[24;1H[?25h[?25l[30;91Hd[24;1H[30;90H  [24;9H[24;29r[29;1H
[1;30r[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;13H[24;29r[29;1H
[1;30r[29;9Hstage('Build Docker Image - Database') {[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;17H[24;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;13H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;13H[46m}[m[29;17Hdir(SQL_DIR) {[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;9H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;9H[46m}[m[29;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;1H[22;29r[29;1H
[1;30r[22;13Hsteps {[22;20H[K[23;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;17H}[30;100H[K[30;100H24,0-1[8CTop[24;1H[?25h[?25l[30;90Hd[24;1H[?25h[?25l[30;91Hd[24;1H[30;90H  [24;9H[24;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;13H[24;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;17H[24;29r[29;1H
[1;30r[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;21H[24;29r[29;1H
[1;30r[29;9Hstage('Push Docker Image - Database') {[30;100H[K[30;100H24,21[9CTop[24;21H[?25h[?25l[30;90Hd[24;21H[?25h[?25l[30;91Hd[24;21H[30;90H  [24;17H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;17H[46m}[m[29;13Hsteps {[30;100H[K[30;100H24,17[9CTop[24;17H[?25h[?25l[30;90Hd[24;17H[?25h[?25l[30;91Hd[24;17H[30;90H  [24;13H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;13H[46m}[m[29;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER_[29;1H[1m[34m@@@                                                                                                                  [m[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [24;9H[22;29r[29;1H
[1;30r[22;13Hsteps [46m{[m[22;20H[K[23;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[24;9H[46m}[m[28;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;1H[22;29r[29;1H
[1;30r[22;13Hsteps {[22;20H[K[23;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;21Hsh """[30;100H[K[30;100H24,0-1[8CTop[24;1H[?25h[?25l[30;90Hd[24;1H[?25h[?25l[30;91Hd[24;1H[30;90H  [24;9H[24;29r[29;1H
[1;30r[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H24,9[10CTop[24;9H[?25h[?25l[30;90Hd[24;9H[?25h[?25l[30;91Hd[24;9H[30;90H  [24;13H[24;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_DB}[30;100H[K[30;100H24,13[9CTop[24;13H[?25h[?25l[30;90Hd[24;13H[?25h[?25l[30;91Hd[24;13H[30;90H  [23;17H[1;29r[29;1H
[1;30r[23;29r[29;1H
[1;30r[28;21H"""[29;17H}[30;100H[K[30;100H24,17[10C1%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;21H[23;29r[23;1H[2M[1;30r[28;13H}[29;9H}[30;100H[K[30;100H24,21[10C1%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;25H[23;29r[29;1H
[1;30r[30;100H[K[30;100H24,25[10C2%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;9Hstage('Build Docker Image - App') {[30;100H[K[30;100H24,25[10C2%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;21H[23;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,21[10C2%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;17H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;17H[46m}[m[29;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[30;100H[K[30;100H24,17[10C2%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;13H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;13H[46m}[m[29;13H}[30;100H[K[30;100H24,13[10C2%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;9H}[30;100H[K[30;100H24,9[11C2%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[30;100H[K[30;100H24,0-1[9C2%[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;9H[23;29r[29;1H
[1;30r[29;9Hstage('Push Docker Image - App') {[30;100H[K[30;100H24,9[11C2%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,13[10C2%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;17H[23;29r[29;1H
[1;30r[29;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER_[29;1H[1m[34m@@@                                                                                                                  [m[30;100H[K[30;100H24,17[10C2%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;13H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;13H[46m}[m[28;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H24,13[10C2%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;21Hsh """[30;100H[K[30;100H24,9[11C2%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H24,0-1[9C2%[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;9H[23;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_APP}[30;100H[K[30;100H24,9[11C2%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;21H"""[30;100H[K[30;100H24,13[10C2%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;17H[23;29r[29;1H
[1;30r[29;17H}[30;100H[K[30;100H24,17[10C2%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;21H[23;29r[23;1H[2M[1;30r[28;13H}[29;9H}[30;100H[K[30;100H24,21[10C2%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;25H[23;29r[29;1H
[1;30r[30;100H[K[30;100H24,25[10C3%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;9Hstage('Snyk Security Scan - Project Directory') {[30;100H[K[30;100H24,25[10C3%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;21H[23;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,21[10C3%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;17H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;17H[46m}[m[29;17Hsh 'snyk code test . --severity-threshold=medium'[30;100H[K[30;100H24,17[10C3%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;13H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;13H[46m}[m[29;13H}[30;100H[K[30;100H24,13[10C3%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;9H}[30;100H[K[30;100H24,9[11C3%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[30;100H[K[30;100H24,0-1[9C3%[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;9H[23;29r[29;1H
[1;30r[29;9Hstage('Deploy to Kubernetes') {[30;100H[K[30;100H24,9[11C3%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H24,13[10C4%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;17H[23;29r[29;1H
[1;30r[29;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[30;100H[K[30;100H24,17[10C4%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;13H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;13H[46m}[m[29;21Hsh """[30;100H[K[30;100H24,13[10C4%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[30;100H[K[30;100H24,9[11C4%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[30;100H[K[30;100H24,0-1[9C4%[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;9H[23;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[30;100H[K[30;100H24,9[11C5%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[30;100H[K[30;100H24,13[10C5%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;17H[23;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[30;100H[K[30;100H24,17[10C5%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;21H[23;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[30;100H[K[30;100H24,21[10C5%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;21H"""[30;100H[K[30;100H24,25[10C6%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;17H}[30;100H[K[30;100H24,25[10C6%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H24,25[10C7%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H24,25[10C7%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[29;5H}[30;100H[K[30;100H24,25[10C8%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;25H[23;29r[29;1H
[1;30r[30;100H[K[30;100H24,25[10C9%[23;25H[?25h[?25l[30;90Hd[23;25H[?25h[?25l[30;91Hd[23;25H[30;90H  [23;21H[23;29r[29;1H
[1;30r[29;5Hpost {[30;100H[K[30;100H24,21[9C10%[23;21H[?25h[?25l[30;90Hd[23;21H[?25h[?25l[30;91Hd[23;21H[30;90H  [23;17H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;17H[46m}[m[29;9Hsuccess {[30;100H[K[30;100H24,17[9C11%[23;17H[?25h[?25l[30;90Hd[23;17H[?25h[?25l[30;91Hd[23;17H[30;90H  [23;13H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;17H// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;13H[46m}[m[29;13Hecho 'Deploy realizado com sucesso!'[30;100H[K[30;100H24,13[9C12%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;9H}[30;100H[K[30;100H24,9[10C14%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;5H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento
    [46m}[m[29;9Hfailure {[30;100H[K[30;100H24,5[10C16%[23;5H[?25h[?25l[30;90Hd[23;5H[?25h[?25l[30;91Hd[23;5H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;5H [11C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;13Hecho 'A pipeline falhou!'[30;100H[K[30;100H24,0-1[8C20%[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;5H[23;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H24,5[10C25%[23;5H[?25h[?25l[30;90Hd[23;5H[?25h[?25l[30;91Hd[23;5H[30;90H  [23;9H[23;29r[29;1H
[1;30r[29;5H}[30;100H[K[30;100H24,9[10C33%[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;1H}[30;100H[K[30;100H24,13[9C50%[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[30;100H[K[30;100H24,9[10CBot[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps {[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[29;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H24,9[10CBot[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;13H[23;29r[29;1H
[1;30r[29;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H24,13[9CBot[23;13H[?25h[?25l[30;90Hd[23;13H[?25h[?25l[30;91Hd[23;13H[30;90H  [23;9H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;13H    // Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento[23;9H[46m}[m[29;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H24,9[10CBot[23;9H[?25h[?25l[30;90Hd[23;9H[?25h[?25l[30;91Hd[23;9H[30;90H  [23;5H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;9H [7C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento
    [46m}[m[29;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H24,5[10CBot[23;5H[?25h[?25l[30;90Hd[23;5H[?25h[?25l[30;91Hd[23;5H[30;90H  [23;1H[21;29r[29;1H
[1;30r[21;13Hsteps [46m{[m[21;20H[K[22;5H [11C// Imprime a senha completa para verificaÃ§Ã£o em ambiente de desenvolvimento
[46m}[m[29;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H24,1[10CBot[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [23;1H[21;19H{[23;1H[K[24;1H[1m[34m~                                                                                                                    [m[30;103H0-1[23;1H[?25h[?25l[30;90Hd[23;1H[?25h[?25l[30;91Hd[23;1H[30;90H  [22;17H
[1m[34m~                                                                                                                    [m[30;101H3,17 [22;17H[?25h[?25l[30;90Hd[22;17H[?25h[?25l[30;91Hd[22;17H[30;90H  [21;13H
[1m[34m~                                                                                                                    [m[30;101H2,13[21;13H[?25h[?25l[30;90Hd[21;13H[?25h[?25l[30;91Hd[21;13H[30;90H  [20;9H
[1m[34m~                                                                                                                    [m[30;101H1,9 [20;9H[?25h[?25l[30;90Hd[20;9H[?25h[?25l[30;91Hd[20;9H[30;90H  [19;1H
[1m[34m~                                                                                                                    [m[30;101H0,0-1[19;1H[?25h[?25l[30;90Hd[19;1H[?25h[?25l[30;91Hd[19;1H[30;90H  [18;9H[14;35H[46m{[18;9H}[m
[1m[34m~                                                                                                                    [m[30;100H19,9  [18;9H[?25h[?25l[30;90Hd[18;9H[?25h[?25l[30;91Hd[18;9H[30;90H  [17;13H[14;35H{[15;19H[46m{[17;13H}[m
[1m[34m~                                                                                                                    [m[30;101H8,13[17;13H[?25h[?25l[30;90Hd[17;13H[?25h[?25l[30;91Hd[17;13H[30;90H  [16;17H[15;19H{

[1m[34m~                                                                                                                    [m[30;101H7,17[16;17H[?25h[?25l[30;90Hd[16;17H[?25h[?25l[30;91Hd[16;17H[30;90H  [15;13H
[1m[34m~                                                                                                                    [m[30;101H6,13[15;13H[?25h[?25l[30;90Hd[15;13H[?25h[?25l[30;91Hd[15;13H[30;90H  [14;9H
[1m[34m~                                                                                                                    [m[30;101H5,9 [14;9H[?25h[?25l[30;90Hd[14;9H[?25h[?25l[30;91Hd[14;9H[30;90H  [13;5H
[1m[34m~                                                                                                                    [m[30;101H4,5[13;5H[?25h[?25l[30;90Hd[13;5H[?25h[?25l[30;91Hd[13;5H[30;90H  [12;1H
[1m[34m~                                                                                                                    [m[30;101H3,0-1[12;1H[?25h[?25l[30;90Hd[12;1H[?25h[?25l[30;91Hd[12;1H[30;90H  [11;5H[3;17H[46m{[11;5H}[m
[1m[34m~                                                                                                                    [m[30;101H2,5  [11;5H[?25h[?25l[30;90Hd[11;5H[?25h[?25l[30;91Hd[11;5H[30;90H  [10;9H[3;17H{[11;1H[1m[34m~                                                                                                                    [m[30;101H1,9[10;9H[?25h[?25l[30;90Hd[10;9H[?25h[?25l[30;91Hd[10;9H[30;90H  [9;9H
[1m[34m~                                                                                                                    [m[30;101H0[9;9H[?25h[?25l[30;90Hd[9;9H[?25h[?25l[30;91Hd[9;9H[30;90H  [8;9H
[1m[34m~                                                                                                                    [m[30;100H9,9 [8;9H[?25h[?25l[30;90Hd[8;9H[?25h[?25l[30;91Hd[8;9H[30;90H  [7;9H
[1m[34m~                                                                                                                    [m[30;100H8[7;9H[?25h[?25l[30;90Hd[7;9H[?25h[?25l[30;91Hd[7;9H[30;90H  [6;9H
[1m[34m~                                                                                                                    [m[30;100H7[6;9H[?25h[?25l[30;90Hd[6;9H[?25h[?25l[30;91Hd[6;9H[30;90H  [6;9H[1;29r[1;1H[L[1;30r[1;1Hpipeline {[7;1H[1m[34m~                                                                                                                    [m[30;100H[K[30;100H6,9[11CAll[6;9H[?25h[?25l[30;90Hd[6;9H[?25h[?25l[30;91Hd[6;9H[30;90H  [5;9H
[1m[34m~                                                                                                                    [m[30;100H5[5;9H[?25h[?25l[30;90Hd[5;9H[?25h[?25l[30;91Hd[5;9H[30;90H  [4;5H
[1m[34m~                                                                                                                    [m[30;100H4,5[4;5H[?25h[?25l[30;90Hd[4;5H[?25h[?25l[30;91Hd[4;5H[30;90H  [3;1H
[1m[34m~                                                                                                                    [m[30;100H3,0-1[3;1H[?25h[?25l[30;90Hd[3;1H[?25h[?25l[30;91Hd[3;1H[30;90H  [2;5H
[1m[34m~                                                                                                                    [m[30;100H2,5  [2;5H[?25h[?25l[30;90Hd[2;5H[?25h[?25l[30;91Hd[2;5H[30;90H  [1;1H
[1m[34m~                                                                                                                    [m[30;100H1,1[1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[1;1H[K[30;1H--No lines in buffer--[30;100H[K[30;100H0,0-1[9CAll[1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[?25h[?25l[30;90Hd[1;1H[?25h[?25l[30;91Hd[1;1H[30;90H  [1;1H[?25h[?25l[30;1H[1m-- INSERT --[m[30;13H[K[30;100H0,1[11CAll[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;1H[K[4;1H[?25h[?25l    environment {
        DOCKER_REPO = 'k1cornelsenp/pro[5;40H[K[5;40H[?25h[?25ljeto-ecommerce'
        DOCKER_IMAGE_APP = "${DOCKER_REPO}:[6;44H[K[6;44H[?25h[?25llatest"
        DOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[7;53H[K[7;53H[?25h[?25l
        K8S_DIR = 'k8s/'[8;25H[K[9;1H        SQL_DIR = 'sql/'[9;25H[K[10;1H        SN[10;11H[K[10;11H[?25h[?25lYK_TOKEN = credentials('SNYK_AUTH')
        DOCKER_HUB = crede[11;27H[K[11;27H[?25h[?25lntials('DOCKER_HUB')
    }[12;6H[K[13;1H[K[14;1H    stages {[14;13H[K[15;1H        stage('Clone [15;22H[K[15;22H[?25h[?25lRepository') {
            steps {[16;20H[K[17;1H                git 'https:[17;28H[K[17;28H[?25h[?25l//github.com/k1cornelsen/projeto-ecommerce.git'
            }[18;14H[K[19;1H [19;2H[K[19;2H[?25h[?25l[7C}[20;1H[K[21;1H        stage('Docker Hub Login Test') {[21;41H[K[22;1H            [22;13H[K[22;13H[?25h[?25lsteps {
                script {[23;25H[K[24;1H                    // Desativ[24;31H[K[24;31H[?25h[?25la a ocultaÃ§Ã£o de saÃ­[24;51Hda temporariamente
                    s[25;22H[K[25;22H[?25h[?25lh 'set +x'
                    // Imprime a senha completa para[26;53H[K[26;53H[?25h[?25l verificaÃ§Ã£o
                    echo "Senha Docker Hub: ${DO[27;49H[K[27;49H[?25h[?25lCKER_HUB_PSW}"
                    // Tenta fazer login e verif[28;49H[K[28;49H[?25h[?25lica sucesso/falha
                    sh "echo \$DOCKER_HUB_PSW[29;46H[K[29;46H[?25h[?25l | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[?25h[?25l[29;8H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;21H// Reativa a ocultaÃ§Ã£o de saÃ­[28;50Hda[29;21Hsh 'set -x'[30;11H[1m(paste) --[m[30;100H[K[29;7H[?25h[?25l[1;29r[1;1H[3M[1;30r[27;17H}[28;13H}[29;9H} [?25h[?25l[1;29r[1;1H[3M[1;30r[28;9Hstage('Snyk Docker Image Scan - App') {[29;13Hsteps {[11C[?25h[?25l[1;29r[1;1H[2M[1;30r[28;17Hsh """[29;21Hsnyk auth --auth-type=token $SNYK_TOKEN[29;34H[?25h[?25l[1;29r[29;1H
[1;30r[29;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[29;9H[?25h[?25l[1;29r[29;1H
[1;30r[29;17H"""[7C[?25h[?25l[1;29r[1;1H[4M[1;30r[26;13H}[27;9H}[29;9Hstage('Snyk Docker Image Scan - Database') {[29;17H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold[?25h[?25l=medium"[29;30H[?25h[?25l[1;29r[1;1H[4M[1;30r[26;13H}[27;9H}[29;9Hstage('Build Docker Image - Database') {[29;24H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17Hdir(SQL_DIR) {[25C[?25h[?25l[1;29r[29;1H
[1;30r[29;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."  [?25h[?25l[1;29r[1;1H[5M[1;30r[25;17H}[26;13H}[27;9H}[29;9Hstage('Push Docker Image - Database') {[29;18H[?25h[?25l[1;29r[29;1H
[1;30r[29;13Hsteps {[41C[?25h[?25l[1;29r[29;1H
[1;30r[29;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER_[29;1H[1m[34m@@@                                                                                                                  [1;29r[m[29;1H
[1;30r[28;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_US[?25h[?25lR', passwordVariable: 'DOCKER_HUB_PSW')]) {[29;20H[?25h[?25l[1;29r[29;1H
[1;30r[29;21Hsh """[29C[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[29;21H[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_DB}    [?25h[?25l[1;29r[1;1H[2M[1;30r[28;21H"""[29;17H}[7C[?25h[?25l[1;29r[1;1H[4M[1;30r[26;13H}[27;9H}[29;9Hstage('Build Docker Image - App') {[29;24H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."  [?25h[?25l[1;29r[29;1H
[1;30r[29;13H}[27C[?25h[?25l[1;29r[1;1H[3M[1;30r[27;9H}[29;9Hstage('Push Docker Image - App') {[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVari[?25h[?25lable: 'DOCKER_[29;1H[1m[34m@@@                                                                                                                  [1;29r[m[29;1H
[1;30r[28;1H                withCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[?25h[?25l[29;36H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;21Hsh """[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_APP}[29;8H[?25h[?25l[1;29r[29;1H
[1;30r[29;21H"""   [?25h[?25l[1;29r[1;1H[5M[1;30r[25;17H}[26;13H}[27;9H}[29;9Hstage('Snyk Security Scan - Project Directory') {[28;9H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17Hsh 'snyk code test . --severity-thr[?25h[?25leshold=medium'[29;24H[?25h[?25l[1;29r[1;1H[4M[1;30r[26;13H}[27;9H}[29;9Hstage('Deploy to Kubernetes') {[29;27H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG'[?25h[?25l)]) {[29;31H[?25h[?25l[1;29r[1;1H[2M[1;30r[28;21Hsh """[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[29;19H[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml     [?25h[?25l[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-[?25h[?25lbanco.yaml[29;53H[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[29;33H[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[29;23H[?25h[?25l[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[29;9H[?25h[?25l[1;29r[29;1H
[1;30r[29;21H"""     [?25h[?25l[1;29r[1;1H[4M[1;30r[26;17H}[27;13H}[28;9H}
    }[1;29r[1;1H[4M[1;30r[27;5Hpost {[28;9Hsuccess {[29;13Hecho 'Deploy realiza[?25h[?25ldo com sucesso!'[29;19H[?25h[?25l[30;1H[K[1;29r[1;1H[7M[1;30r[23;9H}[24;9Hfailure {[25;13Hecho 'A pipeline falhou!'[26;9H}
    }
}[30;100H118,0-1[7CBot[29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [28;1H[30;102H7,1  [28;1H[?25h[?25l[30;90H~@k[28;1H[30;90H   [27;1H[30;102H6[27;1H[?25h[?25l[30;90H~@k[27;1H[30;90H   [26;1H[30;102H5[26;1H[?25h[?25l[30;90H~@k[26;1H[30;90H   [25;1H[30;102H4[25;1H[?25h[?25l[30;90H~@k[25;1H[30;90H   [24;1H[30;102H3[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[30;102H2[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [22;1H[30;102H1[22;1H[?25h[?25l[30;90H~@k[22;1H[30;90H   [21;1H[30;102H0[21;1H[?25h[?25l[30;90H~@k[21;1H[30;90H   [20;1H[30;101H09[20;1H[?25h[?25l[30;90H~@k[20;1H[30;90H   [19;1H[30;102H8,0-1[19;1H[?25h[?25l[30;90H~@k[19;1H[30;90H   [18;1H[30;102H7,1  [18;1H[?25h[?25l[30;90H~@k[18;1H[30;90H   [17;1H[30;102H6[17;1H[?25h[?25l[30;90H~@k[17;1H[30;90H   [16;1H[30;102H5[16;1H[?25h[?25l[30;90H~@k[16;1H[30;90H   [15;1H[30;102H4[15;1H[?25h[?25l[30;90H~@k[15;1H[30;90H   [14;1H[30;102H3[14;1H[?25h[?25l[30;90H~@k[14;1H[30;90H   [13;1H[30;102H2[13;1H[?25h[?25l[30;90H~@k[13;1H[30;90H   [12;1H[30;102H1[12;1H[?25h[?25l[30;90H~@k[12;1H[30;90H   [11;1H[30;102H0[11;1H[?25h[?25l[30;90H~@k[11;1H[30;90H   [10;1H[30;100H99,1 [10;1H[?25h[?25l[30;90H~@k[10;1H[30;90H   [9;1H[30;101H8[9;1H[?25h[?25l[30;90H~@k[9;1H[30;90H   [8;1H[30;101H7[8;1H[?25h[?25l[30;90H~@k[8;1H[30;90H   [7;1H[30;101H6[7;1H[?25h[?25l[30;90H~@k[7;1H[30;90H   [6;1H[30;101H5[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hsh 'snyk code test . --severity-threshold=medium'[30;100H[K[30;100H94,1[10C98%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H93,1[10C97%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Snyk Security Scan - Project Directory') {[30;100H[K[30;100H92,0-1[8C96%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H91,1[10C95%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H90,1[10C94%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[30;100H[K[30;100H89,1[10C93%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17H}[30;100H[K[30;100H88,1[10C92%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H"""[30;100H[K[30;100H87,1[10C91%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;25Hdocker push ${DOCKER_IMAGE_APP}[30;100H[K[30;100H86,0-1[8C89%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H85,1[10C88%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh """[30;100H[K[30;100H84,1[10C87%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [7;1H[1;29r[1;1H[2L[1;30r[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[2;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H83,1[10C85%[7;1H[?25h[?25l[30;90H~@k[7;1H[30;90H   [6;1H[30;101H2[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H81,1[10C84%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Push Docker Image - App') {[30;100H[K[30;100H80,1[10C83%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H79,1[10C82%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[2L[1;30r[1;13H}[2;9H}[30;100H[K[30;100H78,1[10C80%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[30;100H[K[30;100H77,1[10C78%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H76,1[10C77%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Build Docker Image - App') {[30;100H[K[30;100H75,0-1[8C76%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H74,1[10C75%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H73,1[10C74%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[30;100H[K[30;100H72,1[10C73%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17H}[30;100H[K[30;100H71,1[10C72%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H"""[30;100H[K[30;100H70,1[10C71%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;25Hdocker push ${DOCKER_IMAGE_DB}[30;100H[K[30;100H69,0-1[8C70%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H68,1[10C68%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh """[30;100H[K[30;100H67,1[10C67%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [7;1H[1;29r[1;1H[2L[1;30r[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[2;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H66,1[10C65%[7;1H[?25h[?25l[30;90H~@k[7;1H[30;90H   [6;1H[30;101H5[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H64,1[10C64%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Push Docker Image - Database') {[30;100H[K[30;100H63,1[10C63%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H62,1[10C62%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[2L[1;30r[1;13H}[2;9H}[30;100H[K[30;100H61,1[10C60%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17H}[30;100H[K[30;100H60,1[10C59%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[30;100H[K[30;100H59,1[10C58%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hdir(SQL_DIR) {[30;100H[K[30;100H58,0-1[8C57%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H57,1[10C56%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Build Docker Image - Database') {[29;1H[1m[34m@@@                                                                                                                  [m[30;100H[K[30;100H56,1[10C54%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H55,1[10C54%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H54,1[10C53%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[30;100H[K[30;100H53,1[10C52%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[30;100H[K[30;100H52,1[10C51%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H51,1[10C50%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Snyk Docker Image Scan - Database') {[30;100H[K[30;100H50,0-1[8C48%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H49,1[10C47%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H48,1[10C46%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[30;100H[K[30;100H47,1[10C45%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17H"""[30;100H[K[30;100H46,1[10C44%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[30;100H[K[30;100H45,1[10C43%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsnyk auth --auth-type=token $SNYK_TOKEN[30;100H[K[30;100H44,0-1[8C42%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hsh """[30;100H[K[30;100H43,1[10C41%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H42,1[10C40%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Snyk Docker Image Scan - App') {[30;100H[K[30;100H41,1[10C38%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H40,1[10C37%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H39,1[10C36%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[29;1H[1m[34m@@@                                                                                                                  [m[30;100H[K[30;100H38,1[10C35%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17H}[30;100H[K[30;100H37,1[10C34%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh 'set -x'[30;100H[K[30;100H36,1[10C33%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H// Reativa a ocultaÃ§Ã£o de saÃ­[1;50Hda[30;100H[K[30;100H35,0-1[8C32%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 1"[30;100H[K[30;100H34,1[10C31%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H// Tenta fazer login e verifica sucesso/falha[30;100H[K[30;100H33,1[10C30%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hecho "Senha Docker Hub: ${DOCKER_HUB_PSW}"[30;100H[K[30;100H32,1[10C29%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H// Imprime a senha completa para verificaÃ§Ã£o[30;100H[K[30;100H31,1[10C28%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21Hsh 'set +x'[30;100H[K[30;100H30,1[10C26%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;21H// Desativa a ocultaÃ§Ã£o de saÃ­[1;51Hda temporariamente[30;100H[K[30;100H29,1[10C25%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hscript {[30;100H[K[30;100H28,1[10C24%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H27,1[10C23%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Docker Hub Login Test') {[30;100H[K[30;100H26,1[10C22%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H25,1[10C21%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9H}[30;100H[K[30;100H24,1[10C20%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13H}[30;100H[K[30;100H23,1[10C19%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[30;100H[K[30;100H22,1[10C17%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;13Hsteps {[30;100H[K[30;100H21,1[10C16%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9Hstage('Clone Repository') {[30;100H[K[30;100H20,0-1[8C15%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;5Hstages {[30;100H[K[30;100H19,1[10C14%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H18,1[10C13%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;5H}[30;100H[K[30;100H17,1[10C12%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HDOCKER_HUB = credentials('DOCKER_HUB')[30;100H[K[30;100H16,1[10C11%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HSNYK_TOKEN = credentials('SNYK_AUTH')[30;100H[K[30;100H15,1[10C10%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HSQL_DIR = 'sql/'[30;100H[K[30;100H14,1[11C8%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HK8S_DIR = 'k8s/'[30;100H[K[30;100H13,0-1[9C7%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[30;100H[K[30;100H12,1[11C6%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[30;100H[K[30;100H11,1[11C5%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[30;100H[K[30;100H10,1[11C4%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;5Henvironment {[30;100H[K[30;100H9,1[12C3%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[30;100H[K[30;100H8,1[12C2%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;5Hagent any[30;100H[K[30;100H7,1[12C1%[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [6;1H[1;29r[1;1H[L[1;30r[1;1Hpipeline {[30;100H[K[30;100H6,1[11CTop[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [5;1H[30;100H5[5;1H[?25h[?25l[30;90H~@k[5;1H[30;90H   [4;1H[30;100H4[4;1H[?25h[?25l[30;90H~@k[4;1H[30;90H   [3;1H[30;100H3,0-1[3;1H[?25h[?25l[30;90H~@k[3;1H[30;90H   [2;1H[30;100H2,1  [2;1H[?25h[?25l[30;90H~@k[2;1H[30;90H   [1;1H[30;100H1[1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [1;1H[?25h[?25l[30;90H~@k[1;1H[30;90H   [2;1H[30;100H2[2;1H[?25h[?25l[30;90H~@k[2;1H[30;90H   [3;1H[30;100H3,0-1[3;1H[?25h[?25l[30;90H~@k[3;1H[30;90H   [4;1H[30;100H4,1  [4;1H[?25h[?25l[30;90H~@k[4;1H[30;90H   [5;1H[30;100H5[5;1H[?25h[?25l[30;90H~@k[5;1H[30;90H   [6;1H[30;100H6[6;1H[?25h[?25l[30;90H~@k[6;1H[30;90H   [7;1H[30;100H7[7;1H[?25h[?25l[30;90H~@k[7;1H[30;90H   [8;1H[30;100H8[8;1H[?25h[?25l[30;90H~@k[8;1H[30;90H   [9;1H[30;100H9[9;1H[?25h[?25l[30;90H~@k[9;1H[30;90H   [10;1H[30;100H10,1[10;1H[?25h[?25l[30;90H~@k[10;1H[30;90H   [11;1H[30;101H1[11;1H[?25h[?25l[30;90H~@k[11;1H[30;90H   [12;1H[30;101H2[12;1H[?25h[?25l[30;90H~@k[12;1H[30;90H   [13;1H[30;101H3,0-1[13;1H[?25h[?25l[30;90H~@k[13;1H[30;90H   [14;1H[30;101H4,1  [14;1H[?25h[?25l[30;90H~@k[14;1H[30;90H   [15;1H[30;101H5[15;1H[?25h[?25l[30;90H~@k[15;1H[30;90H   [16;1H[30;101H6[16;1H[?25h[?25l[30;90H~@k[16;1H[30;90H   [17;1H[30;101H7[17;1H[?25h[?25l[30;90H~@k[17;1H[30;90H   [18;1H[30;101H8[18;1H[?25h[?25l[30;90H~@k[18;1H[30;90H   [19;1H[30;101H9[19;1H[?25h[?25l[30;90H~@k[19;1H[30;90H   [20;1H[30;100H20,0-1[20;1H[?25h[?25l[30;90H~@k[20;1H[30;90H   [21;1H[30;101H1,1  [21;1H[?25h[?25l[30;90H~@k[21;1H[30;90H   [22;1H[30;101H2[22;1H[?25h[?25l[30;90H~@k[22;1H[30;90H   [23;1H[30;101H3[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[30;101H4[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21H// Reativa a ocultaÃ§Ã£o de saÃ­[29;50Hda[30;100H[K[30;100H25,1[11C1%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsh 'set -x'[30;100H[K[30;100H26,1[11C2%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17H}[30;100H[K[30;100H27,1[11C3%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H28,1[11C4%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H29,1[11C5%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H30,1[11C6%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Snyk Docker Image Scan - App') {[30;100H[K[30;100H31,1[11C7%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H32,1[11C8%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17Hsh """[30;100H[K[30;100H33,1[10C10%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsnyk auth --auth-type=token $SNYK_TOKEN[30;100H[K[30;100H34,1[10C11%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[30;100H[K[30;100H35,0-1[8C12%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17H"""[30;100H[K[30;100H36,1[10C13%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H37,1[10C14%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H38,1[10C15%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H39,1[10C16%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Snyk Docker Image Scan - Database') {[30;100H[K[30;100H40,1[10C17%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H41,1[10C19%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[30;100H[K[30;100H42,1[10C20%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H43,1[10C21%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H44,0-1[8C22%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H45,1[10C23%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Build Docker Image - Database') {[30;100H[K[30;100H46,1[10C24%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H47,1[10C25%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17Hdir(SQL_DIR) {[30;100H[K[30;100H48,1[10C26%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[30;100H[K[30;100H49,1[10C28%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17H}[30;100H[K[30;100H50,0-1[8C29%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H51,1[10C30%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H52,1[10C31%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H53,1[10C32%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Push Docker Image - Database') {[30;100H[K[30;100H54,1[10C33%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H55,1[10C34%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H56,1[10C36%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[30;101H7[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsh """[30;100H[K[30;100H58,0-1[8C37%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H59,1[10C38%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_DB}[30;100H[K[30;100H60,1[10C40%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;21H"""[29;17H}[30;100H[K[30;100H61,1[10C42%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H62,1[10C43%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H63,1[10C44%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H64,1[10C45%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Build Docker Image - App') {[30;100H[K[30;100H65,1[10C46%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H66,1[10C47%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[30;100H[K[30;100H67,1[10C48%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H68,1[10C50%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H69,0-1[8C51%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H70,1[10C52%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Push Docker Image - App') {[30;100H[K[30;100H71,1[10C53%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H72,1[10C54%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariable: 'DOCKER__[29;1HHUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[30;100H[K[30;100H73,1[10C56%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[30;101H4[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsh """[30;100H[K[30;100H75,0-1[8C57%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[30;100H[K[30;100H76,1[10C58%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hdocker push ${DOCKER_IMAGE_APP}[30;100H[K[30;100H77,1[10C59%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;21H"""[29;17H}[30;100H[K[30;100H78,1[10C61%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H79,1[10C62%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H80,1[10C63%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H81,1[10C64%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Snyk Security Scan - Project Directory') {[30;100H[K[30;100H82,1[10C65%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;13Hsteps {[29;17Hsh 'snyk code test . --severity-threshold=medium'[30;100H[K[30;100H83,1[10C67%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[30;101H4[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H85,1[10C68%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H86,0-1[8C70%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H87,1[10C71%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hstage('Deploy to Kubernetes') {[30;100H[K[30;100H88,1[10C72%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hsteps {[30;100H[K[30;100H89,1[10C73%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[30;100H[K[30;100H90,1[10C74%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21Hsh """[30;100H[K[30;100H91,1[10C75%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[30;100H[K[30;100H92,0-1[8C76%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[30;100H[K[30;100H93,1[10C77%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[30;100H[K[30;100H94,1[10C78%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[30;100H[K[30;100H95,1[10C80%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[30;100H[K[30;100H96,1[10C81%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[30;100H[K[30;100H97,1[10C82%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;21H"""[30;100H[K[30;100H98,1[10C83%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;17H}[30;100H[K[30;100H99,1[10C84%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13H}[30;100H[K[30;100H100,1[9C85%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [23;1H[1;29r[1;1H[2M[1;30r[28;9H}
    }[30;100H[K[30;100H101,1[9C87%[23;1H[?25h[?25l[30;90H~@k[23;1H[30;90H   [24;1H[30;102H2[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H103,1[9C88%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;5Hpost {[30;100H[K[30;100H104,1[9C89%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hsuccess {[30;100H[K[30;100H105,1[9C91%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hecho 'Deploy realizado com sucesso!'[30;100H[K[30;100H106,1[9C92%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H107,1[9C93%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9Hfailure {[30;100H[K[30;100H108,0-1[7C94%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;13Hecho 'A pipeline falhou!'[30;100H[K[30;100H109,1[9C95%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;9H}[30;100H[K[30;100H110,1[9C96%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;5H}[30;100H[K[30;100H111,1[9C97%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[29;1H}[30;100H[K[30;100H112,1[9C98%[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [24;1H[1;29r[29;1H
[1;30r[30;100H[K[30;100H113,1[9CBot[24;1H[?25h[?25l[30;90H~@k[24;1H[30;90H   [25;1H[30;102H4[25;1H[?25h[?25l[30;90H~@k[25;1H[30;90H   [26;1H[30;102H5[26;1H[?25h[?25l[30;90H~@k[26;1H[30;90H   [27;1H[30;102H6[27;1H[?25h[?25l[30;90H~@k[27;1H[30;90H   [28;1H[30;102H7[28;1H[?25h[?25l[30;90H~@k[28;1H[30;90H   [29;1H[30;102H8,0-1[29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H~@k[29;1H[30;90H   [29;1H[?25h[?25l[30;90H^[[29;1H[30;90H  [29;1H[30;90H^[[29;1H[30;90H  [29;1H[?25h[?25l[30;90H:[29;1H[30;90H[K[30;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 118L, 4016B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "teste senha dockerhub4"
[?2004l[master 36e43c1] teste senha dockerhub4
 1 file changed, 10 insertions(+), 5 deletions(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git push origin master
[?2004lEnumerating objects: 5, done.
Counting objects:  20% (1/5)Counting objects:  40% (2/5)Counting objects:  60% (3/5)Counting objects:  80% (4/5)Counting objects: 100% (5/5)Counting objects: 100% (5/5), done.
Delta compression using up to 5 threads
Compressing objects:  33% (1/3)Compressing objects:  66% (2/3)Compressing objects: 100% (3/3)Compressing objects: 100% (3/3), done.
Writing objects:  33% (1/3)Writing objects:  66% (2/3)Writing objects: 100% (3/3)Writing objects: 100% (3/3), 432 bytes | 432.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/2)[Kremote: Resolving deltas:  50% (1/2)[Kremote: Resolving deltas: 100% (2/2)[Kremote: Resolving deltas: 100% (2/2), completed with 2 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   97e4070..36e43c1  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [K]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [7msudo usermod -aG docker jenkins[27m
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Csudo usermod -aG docker jenkins
[A
[?2004l[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# chmod 666 /var/hun/[K[K[K[Krun/docker.sock
[?2004l[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Dockerfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Dockerfile" 20L, 531B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1H[33mFROM[m php:8.1-apache[2;1H[K[3;1H[34m# Instala as dependÃª[3;21Hncias necessÃ¡[3;34Hrias e a extensÃ£o mysqli[m[3;58H[K[4;1H[33mRUN[m apt-get update [33m&&[m apt-get install [35m-y[m [33m\[m
    libmariadb-dev-compat [33m\[m
    libmariadb-dev [33m\[m
    default-mysql-client [33m\
[m    [33m&&[m docker-php-ext-install mysqli [33m\
[m    [33m&&[m docker-php-ext-enable mysqli

[34m# Copia o cÃ³[11;13Hdigo da aplicaÃ§Ã£o para o diretÃ³[11;44Hrio padrÃ£o do Apache[m
[33mCOPY[m . /var/www/html/

[34m# Ajusta permissÃµes para o Apache[m
[33mRUN[m chown [35m-R[m www-data:www-data /var/www/html [33m\
[m    [33m&&[m [33mchmod[m [35m-R[m [31m755[m /var/www/html

[34m# ExpÃµe a porta 80 para o Apache[m
[33mEXPOSE[m 80

[1m[34m~                                                                                                          [22;1H~                                                                                                          [23;1H~                                                                                                          [24;1H~                                                                                                          [25;1H~                                                                                                          [26;1H~                                                                                                          [27;1H~                                                                                                          [28;1H~                                                                                                          [29;1H~                                                                                                          [30;1H~                                                                                                          [31;1H~                                                                                                          [32;1H~                                                                                                          [m[33;90H20,0-1[8CAll[20;1H[?25h[?25l[33;80H~@k[20;1H[33;80H   [19;1H[33;90H19,1  [19;1H[?25h[?25l[33;80H~@k[19;1H[33;80H   [18;1H[33;91H8[18;1H[?25h[?25l[33;80H~@k[18;1H[33;80H   [17;1H[33;91H7,0-1[17;1H[?25h[?25l[33;80H~@k[17;1H[33;80H   [16;1H[33;91H6,1  [16;1H[?25h[?25l[33;80H~@k[16;1H[33;80H   [15;1H[33;91H5[15;1H[?25h[?25l[33;80H~@k[15;1H[33;80H   [14;1H[33;91H4[14;1H[?25h[?25l[33;80H~@k[14;1H[33;80H   [13;1H[33;91H3,0-1[13;1H[?25h[?25l[33;80H~@k[13;1H[33;80H   [12;1H[33;91H2,1  [12;1H[?25h[?25l[33;80H~@k[12;1H[33;80H   [11;1H[33;91H1[11;1H[?25h[?25l[33;80H~@k[11;1H[33;80H   [10;1H[33;91H0,0-1[10;1H[?25h[?25l[33;80H~@k[10;1H[33;80H   [9;1H[33;90H9,1   [9;1H[?25h[?25l[33;80H~@k[9;1H[33;80H   [8;1H[33;90H8[8;1H[?25h[?25l[33;80H~@k[8;1H[33;80H   [7;1H[33;90H7[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [6;1H[33;90H6[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [6;1H[33;90H6[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [7;1H[33;90H7[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [8;1H[33;90H8[8;1H[?25h[?25l[33;80H~@k[8;1H[33;80H   [9;1H[33;90H9[9;1H[?25h[?25l[33;80H~@k[9;1H[33;80H   [10;1H[33;90H10,0-1[10;1H[?25h[?25l[33;80H~@k[10;1H[33;80H   [9;1H[33;90H9,1   [9;1H[?25h[?25l[33;80H~@k[9;1H[33;80H   [8;1H[33;90H8[8;1H[?25h[?25l[33;80H~@k[8;1H[33;80H   [7;1H[33;90H7[7;1H[?25h[?25l[33;80H~@k[7;1H[33;80H   [6;1H[33;90H6[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [4;1H[33;90H4[4;1H[?25h[?25l[33;80H~@k[4;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [6;1H[33;90H6[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [4;1H[33;90H4[4;1H[?25h[?25l[33;80H~@k[4;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [6;1H[33;90H6[6;1H[?25h[?25l[33;80H~@k[6;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H~@k[5;1H[33;80H   [4;1H[33;90H4[4;1H[?25h[?25l[33;80H~@k[4;1H[33;80H   [5;1H[33;90H5[5;1H[?25h[?25l[33;80H^[[5;1H[33;80H  [5;1H[33;80H^[[5;1H[33;80H  [5;1H[?25h[?25l[33;80H:[5;1H[33;1H[K[33;1H:[?25hq![?25l[?2004l[>4;m[23;2t[23;1t[33;1H[K[33;1H[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# cat Dockerfile 
[?2004lFROM php:8.1-apache

# Instala as dependÃªncias necessÃ¡rias e a extensÃ£o mysqli
RUN apt-get update && apt-get install -y \
    libmariadb-dev-compat \
    libmariadb-dev \
    default-mysql-client \
    && docker-php-ext-install mysqli \
    && docker-php-ext-enable mysqli

# Copia o cÃ³digo da aplicaÃ§Ã£o para o diretÃ³rio padrÃ£o do Apache
COPY . /var/www/html/

# Ajusta permissÃµes para o Apache
RUN chown -R www-data:www-data /var/www/html \
    && chmod -R 755 /var/www/html

# ExpÃµe a porta 80 para o Apache
EXPOSE 80

[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# [7mFROM php:8.1-apache[27m

[7m# Instala as dependÃªncias necessÃ¡rias e a extensÃ£o mysqli[27m
[7mRUN apt-get update && apt-get install -y \[27m
[7m    libmariadb-dev-compat \[27m
[7m    libmariadb-dev \[27m
[7m    default-mysql-client \[27m
[7m    && docker-php-ext-install mysqli \[27m
[7m    && docker-php-ext-enable mysqli[27m

[7m# Copia o cÃ³digo da aplicaÃ§Ã£o para o diretÃ³rio padrÃ£o do Apache[27m
[7mCOPY . /var/www/html/[27m

[7m# Ajusta permissÃµes para o Apache[27m
[7mRUN chown -R www-data:www-data /var/www/html \[27m
[7m    && chmod -R 755 /var/www/html[27m

[7m# ExpÃµe a porta 80 para o Apache[27m
[7mEXPOSE 80[27m
[A[A[A[A[A[A[A[A[A[A[A[A[A[A[A[A[A[A[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[CFROM php:8.1-apache

# Instala as dependÃªncias necessÃ¡rias e a extensÃ£o mysqli
RUN apt-get update && apt-get install -y \
    libmariadb-dev-compat \
    libmariadb-dev \
    default-mysql-client \
    && docker-php-ext-install mysqli \
    && docker-php-ext-enable mysqli

# Copia o cÃ³digo da aplicaÃ§Ã£o para o diretÃ³rio padrÃ£o do Apache
COPY . /var/www/html/

# Ajusta permissÃµes para o Apache
RUN chown -R www-data:www-data /var/www/html \
    && chmod -R 755 /var/www/html

# ExpÃµe a porta 80 para o Apache
EXPOSE 80
[A
[?2004lbash: FROM: command not found
bash: RUN: command not found
bash: COPY: command not found
bash: RUN: command not found
bash: EXPOSE: command not found
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi Dockerfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Dockerfile" 20L, 531B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;1H[33mFROM[m php:8.1-apache[2;1H[K[3;1H[34m# Instala as dependÃª[3;21Hncias necessÃ¡[3;34Hrias e a extensÃ£o mysqli[m[3;58H[K[4;1H[33mRUN[m apt-get update [33m&&[m apt-get install [35m-y[m [33m\[m
    libmariadb-dev-compat [33m\[m
    libmariadb-dev [33m\[m
    default-mysql-client [33m\
[m    [33m&&[m docker-php-ext-install mysqli [33m\
[m    [33m&&[m docker-php-ext-enable mysqli

[34m# Copia o cÃ³[11;13Hdigo da aplicaÃ§Ã£o para o diretÃ³[11;44Hrio padrÃ£o do Apache[m
[33mCOPY[m . /var/www/html/

[34m# Ajusta permissÃµes para o Apache[m
[33mRUN[m chown [35m-R[m www-data:www-data /var/www/html [33m\
[m    [33m&&[m [33mchmod[m [35m-R[m [31m755[m /var/www/html

[34m# ExpÃµe a porta 80 para o Apache[m
[33mEXPOSE[m 80

[1m[34m~                                                                                                          [22;1H~                                                                                                          [23;1H~                                                                                                          [24;1H~                                                                                                          [25;1H~                                                                                                          [26;1H~                                                                                                          [27;1H~                                                                                                          [28;1H~                                                                                                          [29;1H~                                                                                                          [30;1H~                                                                                                          [31;1H~                                                                                                          [32;1H~                                                                                                          [m[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;5H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;1H[K[33;90H5,5[11CAll[5;5H[?25h[?25l[33;80Hd[5;5H[?25h[?25l[33;81Hd[5;5H[33;80H  [5;5H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,5[11CAll[5;5H[?25h[?25l[33;80Hd[5;5H[?25h[?25l[33;81Hd[5;5H[33;80H  [5;5H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,5[11CAll[5;5H[?25h[?25l[33;80Hd[5;5H[?25h[?25l[33;81Hd[5;5H[33;80H  [5;5H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,5[11CAll[5;5H[?25h[?25l[33;80Hd[5;5H[?25h[?25l[33;81Hd[5;5H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,0-1[9CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[5;1HCOPY[33m . [m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,0-1[9CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[5;1HRUN[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;5H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,5[11CAll[5;5H[?25h[?25l[33;80Hd[5;5H[?25h[?25l[33;81Hd[5;5H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,0-1[9CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[5;1HEXPOSE [31m80[m[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,1[11CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [5;1H[5;32r[32;1H
[1;33r[32;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H5,0-1[9CAll[5;1H[?25h[?25l[33;80Hd[5;1H[?25h[?25l[33;81Hd[5;1H[33;80H  [4;1H
[1m[34m~                                                                                                          [m[33;90H4,1  [4;1H[?25h[?25l[33;80Hd[4;1H[?25h[?25l[33;81Hd[4;1H[33;80H  [3;1H
[1m[34m~                                                                                                          [m[33;90H3[3;1H[?25h[?25l[33;80Hd[3;1H[?25h[?25l[33;81Hd[3;1H[33;80H  [2;1H
[1m[34m~                                                                                                          [m[33;90H2,0-1[2;1H[?25h[?25l[33;80Hd[2;1H[?25h[?25l[33;81Hd[2;1H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1,1  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;80H [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1H[33mFROM[m php:8.1-apache[2;1H[K[3;1H[34m# Instala apenas as dependÃª[3;28Hncias esse[m[3;38H[K[3;38H[?25h[?25l[34mnciais para mysqli, sem bibliotecas adicionais com vulnerabilida[?25h[?25ldes[m
[33mRUN[m apt-get update [33m&&[m apt-get install [35m-y[m [33m\[m[4;43H[K[5;1H    libmariadb-de[5;18H[K[5;18H[?25h[?25lv-compat [33m\[m
    default-mysql-client [33m\[m[6;27H[K[7;1H    [33m&&[m docker-php-ext-ins[7;26H[K[7;26H[?25h[?25ltall mysqli [33m\[m
    [33m&&[m docker-php-ext-enable mysqli[8;36H[K[9;1H[K[10;1H[34m# Remove bib[m[10;13H[K[10;13H[?25h[?25l[34mliotecas que causam vulnerabilidades conhecidas[m
[33mRUN[m apt-get rem[11;16H[K[11;16H[?25h[?25love [35m-y[m [33m\[m
    zlib1g-dev [33m\[m[12;17H[K[13;1H    libsqlite3-0 [33m\[m[13;19H[K[14;1H    libpam0g [33m\[m[14;15H[K[15;1H   [15;4H[K[15;4H[?25h[?25l libapr1 [33m\[m
    [33m&&[m apt-get clean [33m&&[m [33mrm[m [35m-rf[m /var/lib/apt/lists/*[16;52H[K[17;1H[K[17;1H[?25h[?25l
[34m# Copia o cÃ³[18;13Hdigo da aplicaÃ§Ã£o para o diretÃ³[18;44Hrio padrÃ£o do [m[18;58H[K[18;58H[?25h[?25l[34mApache[m
[33mCOPY[m . /var/www/html/[19;22H[K[20;1H[K[21;1H[34m# Ajusta permissÃµes para o Apach[m[21;33H[K[21;33H[?25h[?25l[34me[m
[33mRUN[m chown [35m-R[m www-data:www-data /var/www/html [33m\[m[22;47H[K[23;1H    [33m&&[m [33mchmod[m -[23;15H[K[23;15H[?25h[?25l[35m-R[m [31m755[m /var/www/html[24;1H[K[25;1H[34m# ExpÃµe a porta 80 para o Apache[m[25;33H[K[26;1H[33mEXPOSE[m 8[26;9H[K[26;9H[?25h[?25l[33;1H[K[26;9H0[27;1H[K[33;90H27,0-1[8CAll[27;1H[?25h[?25l[33;80H^[[27;1H[33;80H  [27;1H[33;80H^[[27;1H[33;80H  [27;1H[?25h[?25l[33;80H:[27;1H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Dockerfile" 27L, 757B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# docker build -t k1cornelsenp/projeto-ecommerce:latest .
[?2004lDEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  557.1kBSending build context to Docker daemon  7.587MB
Step 1/6 : FROM php:8.1-apache
 ---> 50977af08c78
Step 2/6 : RUN apt-get update && apt-get install -y     libmariadb-dev-compat     default-mysql-client     && docker-php-ext-install mysqli     && docker-php-ext-enable mysqli
 ---> Running in eaaf75d41a48
Get:1 http://deb.debian.org/debian bookworm InRelease [151 kB]
Get:2 http://deb.debian.org/debian bookworm-updates InRelease [55.4 kB]
Get:3 http://deb.debian.org/debian-security bookworm-security InRelease [48.0 kB]
Get:4 http://deb.debian.org/debian bookworm/main amd64 Packages [8789 kB]
Get:5 http://deb.debian.org/debian bookworm-updates/main amd64 Packages [2468 B]
Get:6 http://deb.debian.org/debian-security bookworm-security/main amd64 Packages [190 kB]
Fetched 9236 kB in 2s (6040 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  libbsd0 libconfig-inifiles-perl libdbd-mariadb-perl libdbi-perl libedit2
  libgpm2 libmariadb-dev libmariadb3 libncurses6 libssl-dev libssl3
  libterm-readkey-perl mariadb-client mariadb-client-core mariadb-common
  mysql-common openssl zlib1g-dev
Suggested packages:
  libclone-perl libmldbm-perl libnet-daemon-perl libsql-statement-perl gpm
  libssl-doc
The following NEW packages will be installed:
  default-mysql-client libbsd0 libconfig-inifiles-perl libdbd-mariadb-perl
  libdbi-perl libedit2 libgpm2 libmariadb-dev libmariadb-dev-compat
  libmariadb3 libncurses6 libssl-dev libterm-readkey-perl mariadb-client
  mariadb-client-core mariadb-common mysql-common zlib1g-dev
The following packages will be upgraded:
  libssl3 openssl
2 upgraded, 18 newly installed, 0 to remove and 21 not upgraded.
Need to get 12.4 MB of archives.
After this operation, 98.6 MB of additional disk space will be used.
Get:1 http://deb.debian.org/debian bookworm/main amd64 libconfig-inifiles-perl all 3.000003-2 [45.9 kB]
Get:2 http://deb.debian.org/debian bookworm/main amd64 mysql-common all 5.8+1.1.0 [6636 B]
Get:3 http://deb.debian.org/debian bookworm/main amd64 mariadb-common all 1:10.11.6-0+deb12u1 [24.4 kB]
Get:4 http://deb.debian.org/debian bookworm/main amd64 libssl3 amd64 3.0.15-1~deb12u1 [2025 kB]
Get:5 http://deb.debian.org/debian bookworm/main amd64 libmariadb3 amd64 1:10.11.6-0+deb12u1 [174 kB]
Get:6 http://deb.debian.org/debian bookworm/main amd64 libbsd0 amd64 0.11.7-2 [117 kB]
Get:7 http://deb.debian.org/debian bookworm/main amd64 libedit2 amd64 3.1-20221030-2 [93.0 kB]
Get:8 http://deb.debian.org/debian bookworm/main amd64 libncurses6 amd64 6.4-4 [103 kB]
Get:9 http://deb.debian.org/debian bookworm/main amd64 mariadb-client-core amd64 1:10.11.6-0+deb12u1 [869 kB]
Get:10 http://deb.debian.org/debian bookworm/main amd64 mariadb-client amd64 1:10.11.6-0+deb12u1 [2931 kB]
Get:11 http://deb.debian.org/debian bookworm/main amd64 default-mysql-client all 1.1.0 [2852 B]
Get:12 http://deb.debian.org/debian bookworm/main amd64 libdbi-perl amd64 1.643-4 [773 kB]
Get:13 http://deb.debian.org/debian bookworm/main amd64 libdbd-mariadb-perl amd64 1.22-1+b1 [93.8 kB]
Get:14 http://deb.debian.org/debian bookworm/main amd64 libgpm2 amd64 1.20.7-10+b1 [14.2 kB]
Get:15 http://deb.debian.org/debian bookworm/main amd64 libssl-dev amd64 3.0.15-1~deb12u1 [2439 kB]
Get:16 http://deb.debian.org/debian bookworm/main amd64 zlib1g-dev amd64 1:1.2.13.dfsg-1 [916 kB]
Get:17 http://deb.debian.org/debian bookworm/main amd64 libmariadb-dev amd64 1:10.11.6-0+deb12u1 [265 kB]
Get:18 http://deb.debian.org/debian bookworm/main amd64 libmariadb-dev-compat amd64 1:10.11.6-0+deb12u1 [23.2 kB]
Get:19 http://deb.debian.org/debian bookworm/main amd64 libterm-readkey-perl amd64 2.38-2+b1 [24.5 kB]
Get:20 http://deb.debian.org/debian bookworm/main amd64 openssl amd64 3.0.15-1~deb12u1 [1427 kB]
[91mdebconf: delaying package configuration, since apt-utils is not installed
[0mFetched 12.4 MB in 3s (4113 kB/s)
Selecting previously unselected package libconfig-inifiles-perl.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 14157 files and directories currently installed.)
Preparing to unpack .../00-libconfig-inifiles-perl_3.000003-2_all.deb ...
Unpacking libconfig-inifiles-perl (3.000003-2) ...
Selecting previously unselected package mysql-common.
Preparing to unpack .../01-mysql-common_5.8+1.1.0_all.deb ...
Unpacking mysql-common (5.8+1.1.0) ...
Selecting previously unselected package mariadb-common.
Preparing to unpack .../02-mariadb-common_1%3a10.11.6-0+deb12u1_all.deb ...
Unpacking mariadb-common (1:10.11.6-0+deb12u1) ...
Preparing to unpack .../03-libssl3_3.0.15-1~deb12u1_amd64.deb ...
Unpacking libssl3:amd64 (3.0.15-1~deb12u1) over (3.0.14-1~deb12u2) ...
Selecting previously unselected package libmariadb3:amd64.
Preparing to unpack .../04-libmariadb3_1%3a10.11.6-0+deb12u1_amd64.deb ...
Unpacking libmariadb3:amd64 (1:10.11.6-0+deb12u1) ...
Selecting previously unselected package libbsd0:amd64.
Preparing to unpack .../05-libbsd0_0.11.7-2_amd64.deb ...
Unpacking libbsd0:amd64 (0.11.7-2) ...
Selecting previously unselected package libedit2:amd64.
Preparing to unpack .../06-libedit2_3.1-20221030-2_amd64.deb ...
Unpacking libedit2:amd64 (3.1-20221030-2) ...
Selecting previously unselected package libncurses6:amd64.
Preparing to unpack .../07-libncurses6_6.4-4_amd64.deb ...
Unpacking libncurses6:amd64 (6.4-4) ...
Selecting previously unselected package mariadb-client-core.
Preparing to unpack .../08-mariadb-client-core_1%3a10.11.6-0+deb12u1_amd64.deb ...
Unpacking mariadb-client-core (1:10.11.6-0+deb12u1) ...
Selecting previously unselected package mariadb-client.
Preparing to unpack .../09-mariadb-client_1%3a10.11.6-0+deb12u1_amd64.deb ...
Unpacking mariadb-client (1:10.11.6-0+deb12u1) ...
Selecting previously unselected package default-mysql-client.
Preparing to unpack .../10-default-mysql-client_1.1.0_all.deb ...
Unpacking default-mysql-client (1.1.0) ...
Selecting previously unselected package libdbi-perl:amd64.
Preparing to unpack .../11-libdbi-perl_1.643-4_amd64.deb ...
Unpacking libdbi-perl:amd64 (1.643-4) ...
Selecting previously unselected package libdbd-mariadb-perl.
Preparing to unpack .../12-libdbd-mariadb-perl_1.22-1+b1_amd64.deb ...
Unpacking libdbd-mariadb-perl (1.22-1+b1) ...
Selecting previously unselected package libgpm2:amd64.
Preparing to unpack .../13-libgpm2_1.20.7-10+b1_amd64.deb ...
Unpacking libgpm2:amd64 (1.20.7-10+b1) ...
Selecting previously unselected package libssl-dev:amd64.
Preparing to unpack .../14-libssl-dev_3.0.15-1~deb12u1_amd64.deb ...
Unpacking libssl-dev:amd64 (3.0.15-1~deb12u1) ...
Selecting previously unselected package zlib1g-dev:amd64.
Preparing to unpack .../15-zlib1g-dev_1%3a1.2.13.dfsg-1_amd64.deb ...
Unpacking zlib1g-dev:amd64 (1:1.2.13.dfsg-1) ...
Selecting previously unselected package libmariadb-dev.
Preparing to unpack .../16-libmariadb-dev_1%3a10.11.6-0+deb12u1_amd64.deb ...
Unpacking libmariadb-dev (1:10.11.6-0+deb12u1) ...
Selecting previously unselected package libmariadb-dev-compat.
Preparing to unpack .../17-libmariadb-dev-compat_1%3a10.11.6-0+deb12u1_amd64.deb ...
Unpacking libmariadb-dev-compat (1:10.11.6-0+deb12u1) ...
Selecting previously unselected package libterm-readkey-perl.
Preparing to unpack .../18-libterm-readkey-perl_2.38-2+b1_amd64.deb ...
Unpacking libterm-readkey-perl (2.38-2+b1) ...
Preparing to unpack .../19-openssl_3.0.15-1~deb12u1_amd64.deb ...
Unpacking openssl (3.0.15-1~deb12u1) over (3.0.14-1~deb12u2) ...
Setting up libconfig-inifiles-perl (3.000003-2) ...
Setting up mysql-common (5.8+1.1.0) ...
update-alternatives: using /etc/mysql/my.cnf.fallback to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Setting up libgpm2:amd64 (1.20.7-10+b1) ...
Setting up libssl3:amd64 (3.0.15-1~deb12u1) ...
Setting up mariadb-common (1:10.11.6-0+deb12u1) ...
update-alternatives: using /etc/mysql/mariadb.cnf to provide /etc/mysql/my.cnf (my.cnf) in auto mode
Setting up libncurses6:amd64 (6.4-4) ...
Setting up libssl-dev:amd64 (3.0.15-1~deb12u1) ...
Setting up libmariadb3:amd64 (1:10.11.6-0+deb12u1) ...
Setting up zlib1g-dev:amd64 (1:1.2.13.dfsg-1) ...
Setting up libterm-readkey-perl (2.38-2+b1) ...
Setting up openssl (3.0.15-1~deb12u1) ...
Setting up libbsd0:amd64 (0.11.7-2) ...
Setting up libdbi-perl:amd64 (1.643-4) ...
Setting up libedit2:amd64 (3.1-20221030-2) ...
Setting up mariadb-client-core (1:10.11.6-0+deb12u1) ...
Setting up libdbd-mariadb-perl (1.22-1+b1) ...
Setting up libmariadb-dev (1:10.11.6-0+deb12u1) ...
Setting up libmariadb-dev-compat (1:10.11.6-0+deb12u1) ...
Setting up mariadb-client (1:10.11.6-0+deb12u1) ...
Setting up default-mysql-client (1.1.0) ...
Processing triggers for libc-bin (2.36-9+deb12u8) ...
Configuring for:
PHP Api Version:         20210902
Zend Module Api No:      20210902
Zend Extension Api No:   420210902
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for a sed that does not truncate output... /usr/bin/sed
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for cc... cc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether the compiler supports GNU C... yes
checking whether cc accepts -g... yes
checking for cc option to enable C11 features... none needed
checking how to run the C preprocessor... cc -E
checking for icc... no
checking for suncc... no
checking for system library directory... lib
checking if compiler supports -Wl,-rpath,... yes
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking target system type... x86_64-pc-linux-gnu
checking for PHP prefix... /usr/local
checking for PHP includes... -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib
checking for PHP extension directory... /usr/local/lib/php/extensions/no-debug-non-zts-20210902
checking for PHP installed headers prefix... /usr/local/include/php
checking if debug is enabled... no
checking if zts is enabled... no
checking for gawk... no
checking for nawk... nawk
checking if nawk is broken... no
checking for MySQLi support... yes, shared
checking for specified location of the MySQL UNIX socket... no
checking for MySQL UNIX socket location... no
checking for a sed that does not truncate output... /usr/bin/sed
checking for ld used by cc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for /usr/bin/ld option to reload object files... -r
checking for BSD-compatible nm... /usr/bin/nm -B
checking whether ln -s works... yes
checking how to recognize dependent libraries... pass_all
checking for stdio.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for strings.h... yes
checking for sys/stat.h... yes
checking for sys/types.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking the maximum length of command line arguments... 1572864
checking command to parse /usr/bin/nm -B output from cc object... ok
checking for objdir... .libs
checking for ar... ar
checking for ranlib... ranlib
checking for strip... strip
checking if cc supports -fno-rtti -fno-exceptions... no
checking for cc option to produce PIC... -fPIC
checking if cc PIC flag -fPIC works... yes
checking if cc static flag -static works... yes
checking if cc supports -c -o file.o... yes
checking whether the cc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... no

creating libtool
appending configuration tag "CXX" to libtool
configure: patching config.h.in
configure: creating ./config.status
config.status: creating config.h
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli.c -o mysqli.lo  -MMD -MF mysqli.dep -MT mysqli.lo
mkdir .libs
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli.c -MMD -MF mysqli.dep -MT mysqli.lo  -fPIC -DPIC -o .libs/mysqli.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_api.c -o mysqli_api.lo  -MMD -MF mysqli_api.dep -MT mysqli_api.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_api.c -MMD -MF mysqli_api.dep -MT mysqli_api.lo  -fPIC -DPIC -o .libs/mysqli_api.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_prop.c -o mysqli_prop.lo  -MMD -MF mysqli_prop.dep -MT mysqli_prop.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_prop.c -MMD -MF mysqli_prop.dep -MT mysqli_prop.lo  -fPIC -DPIC -o .libs/mysqli_prop.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_nonapi.c -o mysqli_nonapi.lo  -MMD -MF mysqli_nonapi.dep -MT mysqli_nonapi.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_nonapi.c -MMD -MF mysqli_nonapi.dep -MT mysqli_nonapi.lo  -fPIC -DPIC -o .libs/mysqli_nonapi.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_report.c -o mysqli_report.lo  -MMD -MF mysqli_report.dep -MT mysqli_report.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_report.c -MMD -MF mysqli_report.dep -MT mysqli_report.lo  -fPIC -DPIC -o .libs/mysqli_report.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_driver.c -o mysqli_driver.lo  -MMD -MF mysqli_driver.dep -MT mysqli_driver.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_driver.c -MMD -MF mysqli_driver.dep -MT mysqli_driver.lo  -fPIC -DPIC -o .libs/mysqli_driver.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_warning.c -o mysqli_warning.lo  -MMD -MF mysqli_warning.dep -MT mysqli_warning.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_warning.c -MMD -MF mysqli_warning.dep -MT mysqli_warning.lo  -fPIC -DPIC -o .libs/mysqli_warning.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_exception.c -o mysqli_exception.lo  -MMD -MF mysqli_exception.dep -MT mysqli_exception.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_exception.c -MMD -MF mysqli_exception.dep -MT mysqli_exception.lo  -fPIC -DPIC -o .libs/mysqli_exception.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=compile cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64   -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_result_iterator.c -o mysqli_result_iterator.lo  -MMD -MF mysqli_result_iterator.dep -MT mysqli_result_iterator.lo
 cc -I. -I/usr/src/php/ext/mysqli -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DZEND_ENABLE_STATIC_TSRMLS_CACHE=1 -DZEND_COMPILE_DL_EXT=1 -c /usr/src/php/ext/mysqli/mysqli_result_iterator.c -MMD -MF mysqli_result_iterator.dep -MT mysqli_result_iterator.lo  -fPIC -DPIC -o .libs/mysqli_result_iterator.o
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=link cc -shared -I/usr/src/php/ext/mysqli/include -I/usr/src/php/ext/mysqli/main -I/usr/src/php/ext/mysqli -I/usr/local/include/php -I/usr/local/include/php/main -I/usr/local/include/php/TSRM -I/usr/local/include/php/Zend -I/usr/local/include/php/ext -I/usr/local/include/php/ext/date/lib  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H  -fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64  -Wl,-O1 -pie  -o mysqli.la -export-dynamic -avoid-version -prefer-pic -module -rpath /usr/src/php/ext/mysqli/modules  mysqli.lo mysqli_api.lo mysqli_prop.lo mysqli_nonapi.lo mysqli_report.lo mysqli_driver.lo mysqli_warning.lo mysqli_exception.lo mysqli_result_iterator.lo 
cc -shared  .libs/mysqli.o .libs/mysqli_api.o .libs/mysqli_prop.o .libs/mysqli_nonapi.o .libs/mysqli_report.o .libs/mysqli_driver.o .libs/mysqli_warning.o .libs/mysqli_exception.o .libs/mysqli_result_iterator.o   -Wl,-O1 -Wl,-soname -Wl,mysqli.so -o .libs/mysqli.so
creating mysqli.la
(cd .libs && rm -f mysqli.la && ln -s ../mysqli.la mysqli.la)
/bin/bash /usr/src/php/ext/mysqli/libtool --mode=install cp ./mysqli.la /usr/src/php/ext/mysqli/modules
cp ./.libs/mysqli.so /usr/src/php/ext/mysqli/modules/mysqli.so
cp ./.libs/mysqli.lai /usr/src/php/ext/mysqli/modules/mysqli.la
PATH="$PATH:/sbin" ldconfig -n /usr/src/php/ext/mysqli/modules
----------------------------------------------------------------------
Libraries have been installed in:
   /usr/src/php/ext/mysqli/modules

If you ever happen to want to link against installed libraries
in a given directory, LIBDIR, you must either use libtool, and
specify the full pathname of the library, or use the `-LLIBDIR'
flag during linking and do at least one of the following:
   - add LIBDIR to the `LD_LIBRARY_PATH' environment variable
     during execution
   - add LIBDIR to the `LD_RUN_PATH' environment variable
     during linking
   - use the `-Wl,--rpath -Wl,LIBDIR' linker flag
   - have your system administrator add LIBDIR to `/etc/ld.so.conf'

See any operating system documentation about shared libraries for
more information, such as the ld(1) and ld.so(8) manual pages.
----------------------------------------------------------------------

Build complete.
Don't forget to run 'make test'.

[91m+ strip --strip-all modules/mysqli.so
[0mInstalling shared extensions:     /usr/local/lib/php/extensions/no-debug-non-zts-20210902/
Installing header files:          /usr/local/include/php/
find . -name \*.gcno -o -name \*.gcda | xargs rm -f
find . -name \*.lo -o -name \*.o -o -name \*.dep | xargs rm -f
find . -name \*.la -o -name \*.a | xargs rm -f
find . -name \*.so | xargs rm -f
find . -name .libs -a -type d|xargs rm -rf
rm -f libphp.la      modules/* libs/*
rm -f ext/opcache/jit/zend_jit_x86.c
rm -f ext/opcache/jit/zend_jit_arm64.c
rm -f ext/opcache/minilua
[91m
warning: mysqli (mysqli) is already loaded!

[0mRemoving intermediate container eaaf75d41a48
 ---> 1befdda286c5
Step 3/6 : RUN apt-get remove -y     zlib1g-dev     libsqlite3-0     libpam0g     libapr1     && apt-get clean && rm -rf /var/lib/apt/lists/*
 ---> Running in 0559c5ca4ffc
Reading package lists...
Building dependency tree...
Reading state information...
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:
 apt : Depends: adduser but it is not going to be installed
 login : PreDepends: libpam0g (>= 0.99.7.1) but it is not going to be installed
         PreDepends: libpam-runtime but it is not going to be installed
         PreDepends: libpam-modules but it is not going to be installed
 util-linux : PreDepends: libpam0g (>= 0.99.7.1) but it is not going to be installed
              Recommends: sensible-utils but it is not going to be installed
[91mE: Error, pkgProblemResolver::Resolve generated breaks, this may be caused by held packages.
[0mThe command '/bin/sh -c apt-get remove -y     zlib1g-dev     libsqlite3-0     libpam0g     libapr1     && apt-get clean && rm -rf /var/lib/apt/lists/*' returned a non-zero code: 100
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# docker push k1cornelsenp/projeto-ecommerce:latest
[?2004lThe push refers to repository [docker.io/k1cornelsenp/projeto-ecommerce]

[1A[2Ke92b5bdcc1ce: Preparing [1B
[1A[2K8a3e1937c177: Preparing [1B
[1A[2K3b991e1d9b14: Preparing [1B
[1A[2K5f70bf18a086: Preparing [1B
[1A[2Kb729fda526bf: Preparing [1B
[1A[2Kfdb6c4bd474c: Preparing [1B
[1A[2Ka75b1652c80f: Preparing [1B
[1A[2K4cc38c13e49f: Preparing [1B
[1A[2K36202dc132c6: Preparing [1B
[1A[2K491ce39b6b0f: Preparing [1B
[1A[2Kbb68fbdcc455: Preparing [1B
[1A[2K179fe9bcb445: Preparing [1B
[1A[2K2a3fcb0ac2aa: Preparing [1B
[1A[2K8bae78565968: Preparing [1B
[1A[2Kb9394c0b0f52: Preparing [1B
[1A[2K9cb76ea0a15f: Preparing [1B
[1A[2K98b5f35ea9d3: Preparing [1B[7A[2Kbb68fbdcc455: Waiting [7B[6A[2K179fe9bcb445: Waiting [6B[5A[2K2a3fcb0ac2aa: Waiting [5B[4A[2K8bae78565968: Waiting [4B[3A[2Kb9394c0b0f52: Waiting [3B[2A[2K9cb76ea0a15f: Waiting [2B[12A[2Kfdb6c4bd474c: Waiting [12B[11A[2Ka75b1652c80f: Waiting [11B[10A[2K4cc38c13e49f: Waiting [10B[1A[2K98b5f35ea9d3: Waiting [1B[9A[2K36202dc132c6: Waiting [9B[8A[2K491ce39b6b0f: Waiting [8B[17A[2Ke92b5bdcc1ce: Pushing  72.19kB/7.201MB[17B[13A[2Kb729fda526bf: Layer already exists [13B[15A[2K3b991e1d9b14: Layer already exists [15B[16A[2K8a3e1937c177: Pushing  72.19kB/7.201MB[16B[14A[2K5f70bf18a086: Layer already exists [14B[17A[2Ke92b5bdcc1ce: Pushing  176.1kB/7.201MB[17B[16A[2K8a3e1937c177: Pushing  176.1kB/7.201MB[16B[17A[2Ke92b5bdcc1ce: Pushing    471kB/7.201MB[17B[16A[2K8a3e1937c177: Pushing    471kB/7.201MB[16B[16A[2K8a3e1937c177: Pushing  667.6kB/7.201MB[16B[12A[2Kfdb6c4bd474c: Layer already exists [12B[17A[2Ke92b5bdcc1ce: Pushing  667.6kB/7.201MB[17B[11A[2Ka75b1652c80f: Layer already exists [11B[17A[2Ke92b5bdcc1ce: Pushing  962.6kB/7.201MB[17B[10A[2K4cc38c13e49f: Layer already exists [10B[16A[2K8a3e1937c177: Pushing  962.6kB/7.201MB[16B[17A[2Ke92b5bdcc1ce: Pushing  1.257MB/7.201MB[17B[16A[2K8a3e1937c177: Pushing  1.257MB/7.201MB[16B[17A[2Ke92b5bdcc1ce: Pushing  2.241MB/7.201MB[17B[16A[2K8a3e1937c177: Pushing  1.552MB/7.201MB[16B[17A[2Ke92b5bdcc1ce: Pushing  2.634MB/7.201MB[17B[16A[2K8a3e1937c177: Pushing  2.634MB/7.201MB[16B[9A[2K36202dc132c6: Layer already exists [9B[17A[2Ke92b5bdcc1ce: Pushing  4.293MB/7.201MB[17B[16A[2K8a3e1937c177: Pushing  2.929MB/7.201MB[16B[17A[2Ke92b5bdcc1ce: Pushing  7.173MB/7.201MB[17B[17A[2Ke92b5bdcc1ce: Pushing  7.321MB[17B[16A[2K8a3e1937c177: Pushing  4.588MB/7.201MB[16B[16A[2K8a3e1937c177: Pushing  4.858MB/7.201MB[16B[8A[2K491ce39b6b0f: Layer already exists [8B[7A[2Kbb68fbdcc455: Layer already exists [7B[16A[2K8a3e1937c177: Pushing  5.725MB/7.201MB[16B[16A[2K8a3e1937c177: Pushing  6.796MB/7.201MB[16B[16A[2K8a3e1937c177: Pushing  7.321MB[16B[6A[2K179fe9bcb445: Layer already exists [6B[5A[2K2a3fcb0ac2aa: Layer already exists [5B[4A[2K8bae78565968: Layer already exists [4B[3A[2Kb9394c0b0f52: Layer already exists [3B[2A[2K9cb76ea0a15f: Layer already exists [2B[1A[2K98b5f35ea9d3: Layer already exists [1B[17A[2Ke92b5bdcc1ce: Pushed [17B[16A[2K8a3e1937c177: Pushed [16Blatest: digest: sha256:c0cf903840cc11e2bc49f09742891f117d924d536a8391eefe0878b583f45a02 size: 3876
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# cd k8s/
[?2004l[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# ls -la
[?2004ltotal 36
drwxrwxr-x  2 root root 4096 Nov 10 18:39 [0m[01;34m.[0m
drwxrwxr-x 11 root root 4096 Nov 10 19:59 [01;34m..[0m
-rwxr-xr-x  1 root root  216 Nov 10 18:39 [01;32mbanco-pv.yaml[0m
-rw-r--r--  1 root root  190 Nov 10 00:56 banco-pvc.yaml
-rwxr-xr-x  1 root root 1060 Nov 10 18:39 [01;32mcreate-db.yaml[0m
-rwxr-xr-x  1 root root 1061 Nov 10 18:39 [01;32mdeploy-banco.yaml[0m
-rwxr-xr-x  1 root root  300 Nov 10 18:39 [01;32mdeploy-svc-banco.yaml[0m
-rwxr-xr-x  1 root root  197 Nov 10 18:39 [01;32mdeploy-svc.yaml[0m
-rwxr-xr-x  1 root root  645 Nov 10 18:39 [01;32mdeploy.yaml[0m
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# vi[K[Kk[Kmicrok8s kubectl apply -f k[Kbanco-pv.yaml 
[?2004lpersistentvolume/database-pv created
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# microk8s kubectl apply -f banco-pv.yaml [K[K[K[K[K[K[K[K[K[K[K[K[K[Kdeploy-banco.yaml 
[?2004lstatefulset.apps/database created
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# microk8s kubectl apply -f deploy-banco.yaml [C[1@s[1@v[1@c[1@-
[?2004lservice/database-service unchanged
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# microk8s kubectl apply -f deploy-svc-banco.yaml [K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[K[Ky.yaml
[?2004ldeployment.apps/meu-deploy created
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# microk8s kubectl apply -f deploy.yaml-.yamls.yamlv.yamlc.yaml
[?2004lservice/deploy-svc unchanged
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerce/k8sroot@devsecops:/var/www/html/projeto-ecommerce/k8s# cd ..
[?2004l[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# cd [K[K[KV[Kvi Jenkinsfile 
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H"Jenkinsfile" 118L, 4016B[2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[1;9Hstage('Snyk Security Scan - Project Directory') {
            steps {[2;20H[K[3;1H                sh 'snyk code test . --severity-threshold=medium'[3;66H[K[4;13H}[5;9H}[7;9Hstage('Deploy to Kubernetes') {[8;13Hsteps {[9;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[10;21Hsh """[11;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[12;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[13;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[14;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[15;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[16;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[17;21H"""[18;17H}[19;13H}[20;9H}
    }[23;5Hpost {[24;9Hsuccess {[25;13Hecho 'Deploy realizado com sucesso!'[26;9H}[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H118,0-1[7CBot[32;1H[?25h[?25l[33;80Hd[32;1H[?25h[?25l[33;81Hd[32;1H[33;80H  [31;1H
[1m[34m~                                                                                                          [m[33;92H7,1  [31;1H[?25h[?25l[33;80Hd[31;1H[?25h[?25l[33;81Hd[31;1H[33;80H  [30;5H[23;10H[46m{[30;5H}[m
[1m[34m~                                                                                                          [m[33;92H6,5[30;5H[?25h[?25l[33;80Hd[30;5H[?25h[?25l[33;81Hd[30;5H[33;80H  [29;9H[23;10H{[27;17H[46m{[29;9H}[m
[1m[34m~                                                                                                          [m[33;92H5,9[29;9H[?25h[?25l[33;80Hd[29;9H[?25h[?25l[33;81Hd[29;9H[33;80H  [28;13H[27;17H{

[1m[34m~                                                                                                          [m[33;92H4,13[28;13H[?25h[?25l[33;80Hd[28;13H[?25h[?25l[33;81Hd[28;13H[33;80H  [27;9H
[1m[34m~                                                                                                          [m[33;92H3,9 [27;9H[?25h[?25l[33;80Hd[27;9H[?25h[?25l[33;81Hd[27;9H[33;80H  [26;9H[24;17H[46m{[26;9H}[m
[1m[34m~                                                                                                          [m[33;92H2[26;9H[?25h[?25l[33;80Hd[26;9H[?25h[?25l[33;81Hd[26;9H[33;80H  [25;13H[24;17H{

[1m[34m~                                                                                                          [m[33;92H1,13[25;13H[?25h[?25l[33;80Hd[25;13H[?25h[?25l[33;81Hd[25;13H[33;80H  [24;9H
[1m[34m~                                                                                                          [m[33;92H0,9 [24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [23;5H
[1m[34m~                                                                                                          [m[33;91H09,5[23;5H[?25h[?25l[33;80Hd[23;5H[?25h[?25l[33;81Hd[23;5H[33;80H  [22;1H
[1m[34m~                                                                                                          [m[33;92H8,0-1[22;1H[?25h[?25l[33;80Hd[22;1H[?25h[?25l[33;81Hd[22;1H[33;80H  [21;5H
[1m[34m~                                                                                                          [m[33;92H7,5  [21;5H[?25h[?25l[33;80Hd[21;5H[?25h[?25l[33;81Hd[21;5H[33;80H  [20;9H[7;39H[46m{[20;9H}[m
[1m[34m~                                                                                                          [m[33;92H6,9[20;9H[?25h[?25l[33;80Hd[20;9H[?25h[?25l[33;81Hd[20;9H[33;80H  [19;13H[7;39H{[8;19H[46m{[19;13H}[m
[1m[34m~                                                                                                          [m[33;92H5,13[19;13H[?25h[?25l[33;80Hd[19;13H[?25h[?25l[33;81Hd[19;13H[33;80H  [18;17H[8;19H{[9;94H[46m{[18;17H}[m
[1m[34m~                                                                                                          [m[33;92H4,17[18;17H[?25h[?25l[33;80Hd[18;17H[?25h[?25l[33;81Hd[18;17H[33;80H  [17;21H[9;94H{[18;1H[1m[34m~                                                                                                          [m[33;92H3,21[17;21H[?25h[?25l[33;80Hd[17;21H[?25h[?25l[33;81Hd[17;21H[33;80H  [16;25H
[1m[34m~                                                                                                          [m[33;92H2,25[16;25H[?25h[?25l[33;80Hd[16;25H[?25h[?25l[33;81Hd[16;25H[33;80H  [15;25H
[1m[34m~                                                                                                          [m[33;92H1[15;25H[?25h[?25l[33;80Hd[15;25H[?25h[?25l[33;81Hd[15;25H[33;80H  [14;25H
[1m[34m~                                                                                                          [m[33;92H0[14;25H[?25h[?25l[33;80Hd[14;25H[?25h[?25l[33;81Hd[14;25H[33;80H  [13;25H
[1m[34m~                                                                                                          [m[33;90H99,25 [13;25H[?25h[?25l[33;80Hd[13;25H[?25h[?25l[33;81Hd[13;25H[33;80H  [12;25H
[1m[34m~                                                                                                          [m[33;91H8[12;25H[?25h[?25l[33;80Hd[12;25H[?25h[?25l[33;81Hd[12;25H[33;80H  [11;25H
[1m[34m~                                                                                                          [m[33;91H7[11;25H[?25h[?25l[33;80Hd[11;25H[?25h[?25l[33;81Hd[11;25H[33;80H  [10;21H
[1m[34m~                                                                                                          [m[33;91H6,21[10;21H[?25h[?25l[33;80Hd[10;21H[?25h[?25l[33;81Hd[10;21H[33;80H  [9;17H
[1m[34m~                                                                                                          [m[33;91H5,17[9;17H[?25h[?25l[33;80Hd[9;17H[?25h[?25l[33;81Hd[9;17H[33;80H  [8;13H
[1m[34m~                                                                                                          [m[33;91H4,13[8;13H[?25h[?25l[33;80Hd[8;13H[?25h[?25l[33;81Hd[8;13H[33;80H  [7;9H
[1m[34m~                                                                                                          [m[33;91H3,9 [7;9H[?25h[?25l[33;80Hd[7;9H[?25h[?25l[33;81Hd[7;9H[33;80H  [6;1H
[1m[34m~                                                                                                          [m[33;91H2,0-1[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;57H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;1H[K[33;90H91,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;57H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H90,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H89,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H88,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H87,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_APP}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H86,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H85,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;21Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H84,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [7;17H[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[2;1H: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) [46m{[m[2;60H[K[3;21Hsh """[3;27H[K[4;21H    echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[5;17H [7Cdocker push ${DOCKER_IMAGE_APP}[6;13H [7C"""
                [46m}[m[7;18H[K[33;91H3,17[7;17H[?25h[?25l[33;80Hd[7;17H[?25h[?25l[33;81Hd[7;17H[33;80H  [6;21H[2;59H{[7;1H[1m[34m~                                                                                                          [m[33;91H2,21[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H81,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - App') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H80,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H79,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H78,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[7;1H[1m[34m~                                                                                                          [8;1H~                                                                                                          [m[33;90H[K[33;90H77,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H76,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - App') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H75,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;43H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H74,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;43H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H73,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H72,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H71,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H70,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_DB}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H69,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H68,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;21Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H67,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [7;17H[1;17HwithCredentials([usernamePassword(credentialsId: 'docker-hub-credentials', usernameVariablee[2;1H: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) [46m{[m[2;60H[K[3;21Hsh """[3;27H[K[4;21H    echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[5;17H [7Cdocker push ${DOCKER_IMAGE_DB}[6;13H [7C"""
                [46m}[m[7;18H[K[33;91H6,17[7;17H[?25h[?25l[33;80Hd[7;17H[?25h[?25l[33;81Hd[7;17H[33;80H  [6;21H[2;59H{[7;1H[1m[34m~                                                                                                          [m[33;91H5,21[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H64,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - Database') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H63,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H62,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H61,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [8;1H~                                                                                                          [m[33;90H[K[33;90H60,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H59,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;17Hdir(SQL_DIR) {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H58,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H57,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - Database') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H56,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;30H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H55,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;30H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H54,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H53,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H52,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H51,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - Database') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H50,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;52H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H49,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;52H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H48,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H47,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H46,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H45,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;21Hsnyk auth --auth-type=token $SNYK_TOKEN[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H44,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;17Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H43,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;13Hsteps [46m{[m[1;20H[K[2;17Hsh """[2;23H[K[3;26Hauth --auth-type=token $SNYK_TOKEN[3;61H[K[4;17H    snyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[5;13H    """[6;9H    [46m}[m[33;91H2,13[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - App') {[2;19H{[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H41,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H40,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H39,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H38,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H37,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsh 'set -x'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H36,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;21H// Reativa a ocultaÃ§Ã£o de saÃ­[1;50Hda[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H35,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [7;9H[1;32r[1;1H[2L[1;33r[1;21Hsh "echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin || exit 11[2;1H"[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H34,9[10CBot[7;9H[?25h[?25l[33;80Hd[7;9H[?25h[?25l[33;81Hd[7;9H[33;80H  [6;13H
[1m[34m~                                                                                                          [m[33;91H3,13[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;21H// Tenta fazer login e verifica sucesso/falha[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H32,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;21Hecho "Senha Docker Hub: ${DOCKER_HUB_PSW}"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H31,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;21H// Imprime a senha completa para verificaÃ§Ã£o[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H30,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[2L[1;33r[1;21H// Desativa a ocultaÃ§Ã£o de saÃ­[1;51Hda temporariamente[2;21Hsh 'set +x'[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H29,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;17Hscript {[7;1H[1m[34m~                                                                                                          [8;1H~                                                                                                          [m[33;90H[K[33;90H28,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H27,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9Hstage('Docker Hub Login Test') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H26,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H25,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H23,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H22,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H21,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Clone Repository') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H20,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hstages {[2;35H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H19,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[3;35H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H18,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;5H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H17,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9HDOCKER_HUB = credentials('DOCKER_HUB')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H16,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HSNYK_TOKEN = credentials('SNYK_AUTH')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H15,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HSQL_DIR = 'sql/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H14,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9HK8S_DIR = 'k8s/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H13,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H12,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H11,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H10,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Henvironment {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H9,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H8,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hagent any[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H7,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;1Hpipeline {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H6,9[11CAll[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [5;9H
[1m[34m~                                                                                                          [m[33;90H5[5;9H[?25h[?25l[33;80Hd[5;9H[?25h[?25l[33;81Hd[5;9H[33;80H  [4;5H
[1m[34m~                                                                                                          [m[33;90H4,5[4;5H[?25h[?25l[33;80Hd[4;5H[?25h[?25l[33;81Hd[4;5H[33;80H  [3;1H
[1m[34m~                                                                                                          [m[33;90H3,0-1[3;1H[?25h[?25l[33;80Hd[3;1H[?25h[?25l[33;81Hd[3;1H[33;80H  [2;5H
[1m[34m~                                                                                                          [m[33;90H2,5  [2;5H[?25h[?25l[33;80Hd[2;5H[?25h[?25l[33;81Hd[2;5H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1,1[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[33;1H[K[1;1H39[33;90H1,2[11CAll[1;2H[?25h[?25l[33;80H~@k[1;2H[33;80H   [1;2H[?25h[?25l[33;80H~@k[1;2H[33;80H   [1;1H[33;92H1[1;1H[?25h[?25l[33;80H~@k[1;1H[33;80H   [1;1H[?25h[?25l[33;80H~@k[1;1H[33;80H   [1;1H[?25h[?25l[33;80H~@k[1;1H[33;80H   [1;1H[?25h[?25l[33;80H~@k[1;1H[33;80H   [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;80H [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;1H    environment {[4;18H[K[5;1H        DOCKER[5;15H[K[5;15H[?25h[?25l_REPO = 'k1cornelsenp/projeto-ecommerce'
        DOCKER_IMAGE_AP[6;24H[K[6;24H[?25h[?25lP = "${DOCKER_REPO}:latest"
        DOCKER_IMAGE_DB = "${DOCKER_[7;37H[K[7;37H[?25h[?25lREPO}-db:latest"
        K8S_DIR = 'k8s/'[8;25H[K[9;1H        SQL_DIR = 'sq[9;22H[K[9;22H[?25h[?25ll/'
        SNYK_TOKEN = credentials('SNYK_AUTH')[10;46H[K[11;1H        DOCKE[11;14H[K[11;14H[?25h[?25lR_HUB = credentials('DOCKER_HUB')
    }[12;6H[K[13;1H[K[14;1H    stages {[14;13H[K[15;1H        s[15;10H[K[15;10H[?25h[?25ltage('Clone Repository') {
            steps {[16;20H[K[17;1H                [17;17H[K[17;17H[?25h[?25lgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'
    [18;5H[K[18;5H[?25h[?25l[8C}
        }[19;10H[K[20;1H[K[21;1H        stage('Snyk Docker Image Scan - Ap[21;43H[K[21;43H[?25h[?25lp') {
            steps {[22;20H[K[23;1H                sh """[23;23H[K[24;1H              [24;15H[K[24;15H[?25h[?25l      snyk auth --auth-type=token $SNYK_TOKEN
                 [25;18H[K[25;18H[?25h[?25l   snyk container test ${DOCKER_IMAGE_APP} --severity-threshold[?25h[?25l=medium
                """[26;20H[K[27;1H            }[27;14H[K[28;1H        }[28;10H[K[29;1H[K[30;1H        st[30;11H[K[30;11H[?25h[?25lage('Snyk Docker Image Scan - Database') {
            steps {[31;20H[K[32;1H[K[32;1H[?25h[?25l[16Csh "snyk container test ${DOCKER_IMAGE_DB} --se[?25h[?25lverity-threshold=medium"[32;14H[?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Build Docker Image - Database') {[33;11H[1m(paste) --[m[33;90H[K[32;8H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hdir(SQL_DIR) {[9C[?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[32;12H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;17H}[32;13H} [?25h[?25l[1;32r[1;1H[4M[1;33r[29;9H}[31;9Hstage('Push Docker Image - Database') {[32;13Hsteps {[25C[?25h[?25l[1;32r[32;1H
[1;33r[32;17HwithCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HU[33;1H[?25h[?25l[32;1H[1m[34m@@@                                                                                                        [1;32r[m[1;1H[2M[1;33r[30;1H                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[31;1HB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[32;16H[?25h[?25l     sh """[25C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[32;17H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_DB}[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21H"""[32;17H}   [?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Build Docker Image - App') {[32;20H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile .[?25h[?25l"[32;37H[?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Push Docker Image - App') {[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17HwithCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'D[?25h[?25lOCKER_HU[32;1H[1m[34m@@@                                                                                                        [1;32r[m[1;1H[2M[1;33r[30;1H                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[31;1HB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {[32;8H[?25h[?25l[13Csh """[17C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[32;9H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_APP}[32;16H[?25h[?25l[1;32r[32;1H
[1;33r[32;21H"""[32;12H[?25h[?25l[1;32r[1;1H[5M[1;33r[28;17H}[29;13H}[30;9H}[32;9Hstage('Snyk Security Scan - Project Directory') {[32;17H[?25h[?25l[1;32r[32;1H
[1;33r[32;13Hsteps {[40C[?25h[?25l[1;32r[32;1H
[1;33r[32;17Hsh 'snyk code test . --severity-threshold=medium'[32;32H[?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Deploy to Kubernetes') {[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17HwithCredentials([f[?25h[?25lile(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {  [?25h[?25l[1;32r[32;1H
[1;33r[32;21Hsh """[12C[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml[32;27H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[32;14H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.ya[?25h[?25lml[32;61H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml[32;41H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy.yaml[32;31H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[32;17H[?25h[?25l[1;32r[32;1H
[1;33r[32;21H"""[31;7H[?25h[?25l[1;32r[1;1H[7M[1;33r[26;17H}[27;13H}[28;9H}
    }[31;5Hpost {[32;9Hsuccess {[1;32r[32;1H
[1;33r[32;13Hecho 'Deploy realizado com s[?25h[?25lucesso!'[32;27H[?25h[?25l[33;1H[K[1;32r[1;1H[7M[1;33r[26;9H}[27;9Hfailure {[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H103,0-1[7CBot[32;1H[?25h[?25l[33;80Hd[32;1H[?25h[?25l[33;81Hd[32;1H[33;80H  [31;1H
[1m[34m~                                                                                                          [m[33;92H2,1  [31;1H[?25h[?25l[33;80Hd[31;1H[?25h[?25l[33;81Hd[31;1H[33;80H  [30;5H[23;10H[46m{[30;5H}[m
[1m[34m~                                                                                                          [m[33;92H1,5[30;5H[?25h[?25l[33;80Hd[30;5H[?25h[?25l[33;81Hd[30;5H[33;80H  [29;9H[23;10H{[27;17H[46m{[29;9H}[m
[1m[34m~                                                                                                          [m[33;92H0,9[29;9H[?25h[?25l[33;80Hd[29;9H[?25h[?25l[33;81Hd[29;9H[33;80H  [28;13H[27;17H{

[1m[34m~                                                                                                          [m[33;90H99,13[28;13H[?25h[?25l[33;80Hd[28;13H[?25h[?25l[33;81Hd[28;13H[33;80H  [27;9H
[1m[34m~                                                                                                          [m[33;91H8,9 [27;9H[?25h[?25l[33;80Hd[27;9H[?25h[?25l[33;81Hd[27;9H[33;80H  [26;9H[24;17H[46m{[26;9H}[m
[1m[34m~                                                                                                          [m[33;91H7[26;9H[?25h[?25l[33;80Hd[26;9H[?25h[?25l[33;81Hd[26;9H[33;80H  [25;13H[24;17H{

[1m[34m~                                                                                                          [m[33;91H6,13[25;13H[?25h[?25l[33;80Hd[25;13H[?25h[?25l[33;81Hd[25;13H[33;80H  [24;9H
[1m[34m~                                                                                                          [m[33;91H5,9 [24;9H[?25h[?25l[33;80Hd[24;9H[?25h[?25l[33;81Hd[24;9H[33;80H  [23;5H
[1m[34m~                                                                                                          [m[33;91H4,5[23;5H[?25h[?25l[33;80Hd[23;5H[?25h[?25l[33;81Hd[23;5H[33;80H  [22;1H
[1m[34m~                                                                                                          [m[33;91H3,0-1[22;1H[?25h[?25l[33;80Hd[22;1H[?25h[?25l[33;81Hd[22;1H[33;80H  [21;5H
[1m[34m~                                                                                                          [m[33;91H2,5  [21;5H[?25h[?25l[33;80Hd[21;5H[?25h[?25l[33;81Hd[21;5H[33;80H  [20;9H[7;39H[46m{[20;9H}[m
[1m[34m~                                                                                                          [m[33;91H1,9[20;9H[?25h[?25l[33;80Hd[20;9H[?25h[?25l[33;81Hd[20;9H[33;80H  [19;13H[7;39H{[8;19H[46m{[19;13H}[m
[1m[34m~                                                                                                          [m[33;91H0,13[19;13H[?25h[?25l[33;80Hd[19;13H[?25h[?25l[33;81Hd[19;13H[33;80H  [18;17H[8;19H{[9;94H[46m{[18;17H}[m
[1m[34m~                                                                                                          [m[33;90H89,17[18;17H[?25h[?25l[33;80Hd[18;17H[?25h[?25l[33;81Hd[18;17H[33;80H  [17;21H[9;94H{[18;1H[1m[34m~                                                                                                          [m[33;91H8,21[17;21H[?25h[?25l[33;80Hd[17;21H[?25h[?25l[33;81Hd[17;21H[33;80H  [16;25H
[1m[34m~                                                                                                          [m[33;91H7,25[16;25H[?25h[?25l[33;80Hd[16;25H[?25h[?25l[33;81Hd[16;25H[33;80H  [15;25H
[1m[34m~                                                                                                          [m[33;91H6[15;25H[?25h[?25l[33;80Hd[15;25H[?25h[?25l[33;81Hd[15;25H[33;80H  [14;25H
[1m[34m~                                                                                                          [m[33;91H5[14;25H[?25h[?25l[33;80Hd[14;25H[?25h[?25l[33;81Hd[14;25H[33;80H  [13;25H
[1m[34m~                                                                                                          [m[33;91H4[13;25H[?25h[?25l[33;80Hd[13;25H[?25h[?25l[33;81Hd[13;25H[33;80H  [12;25H
[1m[34m~                                                                                                          [m[33;91H3[12;25H[?25h[?25l[33;80Hd[12;25H[?25h[?25l[33;81Hd[12;25H[33;80H  [11;25H
[1m[34m~                                                                                                          [m[33;91H2[11;25H[?25h[?25l[33;80Hd[11;25H[?25h[?25l[33;81Hd[11;25H[33;80H  [10;21H
[1m[34m~                                                                                                          [m[33;91H1,21[10;21H[?25h[?25l[33;80Hd[10;21H[?25h[?25l[33;81Hd[10;21H[33;80H  [9;17H
[1m[34m~                                                                                                          [m[33;91H0,17[9;17H[?25h[?25l[33;80Hd[9;17H[?25h[?25l[33;81Hd[9;17H[33;80H  [8;13H
[1m[34m~                                                                                                          [m[33;90H79,13[8;13H[?25h[?25l[33;80Hd[8;13H[?25h[?25l[33;81Hd[8;13H[33;80H  [7;9H
[1m[34m~                                                                                                          [m[33;91H8,9 [7;9H[?25h[?25l[33;80Hd[7;9H[?25h[?25l[33;81Hd[7;9H[33;80H  [6;1H
[1m[34m~                                                                                                          [m[33;91H7,0-1[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;57H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H76,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;57H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H75,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H74,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H73,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H72,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_APP}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H71,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H70,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;21Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H69,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [7;17H[1;17HwithCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[2;1HB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) [46m{[m[2;49H[K[3;21Hsh """[3;27H[K[4;21H    echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[5;17H [7Cdocker push ${DOCKER_IMAGE_APP}[6;13H [7C"""
                [46m}[m[7;18H[K[33;91H8,17[7;17H[?25h[?25l[33;80Hd[7;17H[?25h[?25l[33;81Hd[7;17H[33;80H  [6;21H[2;47H{[7;1H[1m[34m~                                                                                                          [m[33;91H7,21[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H66,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - App') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H65,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H64,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H63,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[7;1H[1m[34m~                                                                                                          [8;1H~                                                                                                          [m[33;90H[K[33;90H62,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H61,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - App') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H60,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;43H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H59,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;43H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H58,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H57,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H56,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H55,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;25Hdocker push ${DOCKER_IMAGE_DB}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H54,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H53,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;21Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H52,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [7;17H[1;17HwithCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[2;1HB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) [46m{[m[2;49H[K[3;21Hsh """[3;27H[K[4;21H    echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin[5;17H [7Cdocker push ${DOCKER_IMAGE_DB}[6;13H [7C"""
                [46m}[m[7;18H[K[33;91H1,17[7;17H[?25h[?25l[33;80Hd[7;17H[?25h[?25l[33;81Hd[7;17H[33;80H  [6;21H[2;47H{[7;1H[1m[34m~                                                                                                          [m[33;91H0,21[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H49,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;25H[1;32r[1;1H[L[1;33r[1;9Hstage('Push Docker Image - Database') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H48,25[9CBot[6;25H[?25h[?25l[33;80Hd[6;25H[?25h[?25l[33;81Hd[6;25H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H47,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[2L[1;33r[1;13H}[2;9H}[8;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H46,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H}[7;1H[1m[34m~                                                                                                          [8;1H~                                                                                                          [m[33;90H[K[33;90H45,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H44,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;17Hdir(SQL_DIR) {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H43,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H42,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9Hstage('Build Docker Image - Database') {[2;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H41,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[3;19H{[4;30H[46m{[6;17H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H40,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[5;30H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H39,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H38,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hsh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H37,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H36,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - Database') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H35,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[2;52H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H34,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9H}[3;52H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H33,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H32,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17H"""[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H31,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;21Hsnyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H30,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;21Hsnyk auth --auth-type=token $SNYK_TOKEN[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H29,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;17Hsh """[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H28,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;13Hsteps [46m{[m[1;20H[K[2;17Hsh """[2;23H[K[3;26Hauth --auth-type=token $SNYK_TOKEN[3;61H[K[4;17H    snyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium[5;13H    """[6;9H    [46m}[m[33;91H7,13[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;9Hstage('Snyk Docker Image Scan - App') {[2;19H{[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H26,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H25,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;21H[1;32r[1;1H[L[1;33r[1;9H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H24,21[9CBot[6;21H[?25h[?25l[33;80Hd[6;21H[?25h[?25l[33;81Hd[6;21H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;13H}[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H23,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;17Hgit 'https://github.com/k1cornelsen/projeto-ecommerce.git'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H22,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;13Hsteps {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H21,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9Hstage('Clone Repository') {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H20,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hstages {[2;35H[46m{[6;9H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H19,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[3;35H{[4;19H[46m{[6;13H}[m
[1m[34m~                                                                                                          [m[33;90H[K[33;90H18,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;17H[1;32r[1;1H[L[1;33r[1;5H}[5;19H{

[1m[34m~                                                                                                          [m[33;90H[K[33;90H17,17[9CBot[6;17H[?25h[?25l[33;80Hd[6;17H[?25h[?25l[33;81Hd[6;17H[33;80H  [6;13H[1;32r[1;1H[L[1;33r[1;9HDOCKER_HUB = credentials('DOCKER_HUB')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H16,13[9CBot[6;13H[?25h[?25l[33;80Hd[6;13H[?25h[?25l[33;81Hd[6;13H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HSNYK_TOKEN = credentials('SNYK_AUTH')[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H15,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HSQL_DIR = 'sql/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H14,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;1H[1;32r[1;1H[L[1;33r[1;9HK8S_DIR = 'k8s/'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H13,0-1[8CBot[6;1H[?25h[?25l[33;80Hd[6;1H[?25h[?25l[33;81Hd[6;1H[33;80H  [6;5H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H12,5[10CBot[6;5H[?25h[?25l[33;80Hd[6;5H[?25h[?25l[33;81Hd[6;5H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H11,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;9HDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H10,9[10CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Henvironment {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H9,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H8,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;5Hagent any[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H7,9[11CBot[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [6;9H[1;32r[1;1H[L[1;33r[1;1Hpipeline {[7;1H[1m[34m~                                                                                                          [m[33;90H[K[33;90H6,9[11CAll[6;9H[?25h[?25l[33;80Hd[6;9H[?25h[?25l[33;81Hd[6;9H[33;80H  [5;9H
[1m[34m~                                                                                                          [m[33;90H5[5;9H[?25h[?25l[33;80Hd[5;9H[?25h[?25l[33;81Hd[5;9H[33;80H  [4;5H
[1m[34m~                                                                                                          [m[33;90H4,5[4;5H[?25h[?25l[33;80Hd[4;5H[?25h[?25l[33;81Hd[4;5H[33;80H  [3;1H
[1m[34m~                                                                                                          [m[33;90H3,0-1[3;1H[?25h[?25l[33;80Hd[3;1H[?25h[?25l[33;81Hd[3;1H[33;80H  [2;5H
[1m[34m~                                                                                                          [m[33;90H2,5  [2;5H[?25h[?25l[33;80Hd[2;5H[?25h[?25l[33;81Hd[2;5H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1,1[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;80H [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hpipeline {
    agent any[2;14H[K[3;1H[K[4;1H    environment {[4;18H[K[5;1H [5;2H[K[5;2H[?25h[?25l[7CDOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'
 [6;2H[K[6;2H[?25h[?25l[7CDOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"
        [7;9H[K[7;9H[?25h[?25lDOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"
        K8S_DI[8;15H[K[8;15H[?25h[?25lR = 'k8s/'
        SQL_DIR = 'sql/'[9;25H[K[10;1H        SNYK_TOKEN = cred[10;26H[K[10;26H[?25h[?25lentials('SNYK_AUTH')
        DOCKER_HUB = credentials('DOCKER[11;41H[K[11;41H[?25h[?25l_HUB')
    }[12;6H[K[13;1H[K[14;1H    stages {[14;13H[K[15;1H        stage('Clone Repository') {[15;36H[K[15;36H[?25h[?25l
            steps {[16;20H[K[17;1H                git 'https://github.com/k[17;42H[K[17;42H[?25h[?25l1cornelsen/projeto-ecommerce.git'
            }[18;14H[K[19;1H        }[19;10H[K[20;1H[K[21;1H    [21;5H[K[21;5H[?25h[?25l    stage('Snyk Docker Image Scan - App') {
            steps {[22;20H[K[22;20H[?25h[?25l
                sh """[23;23H[K[24;1H                    snyk auth --auth-ty[24;40H[K[24;40H[?25h[?25lpe=token $SNYK_TOKEN
                    snyk container test ${[25;43H[K[25;43H[?25h[?25lDOCKER_IMAGE_APP} --severity-threshold=medium
                "[26;18H[K[26;18H[?25h[?25l""
            }[27;14H[K[28;1H        }[28;10H[K[29;1H[K[30;1H        stage('Snyk Docker Image Sc[30;36H[K[30;36H[?25h[?25lan - Database') {
            steps {[31;20H[K[32;1H                sh "snyk [32;26H[K[32;26H[?25h[?25lcontainer test ${DOCKER_IMAGE_DB} --severity-threshold=medium"[?25h[?25l[1;32r[32;1H
[1;33r[32;13H}[33;11H[1m(paste) --[m[33;90H[K[32;39H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;9H}[32;9Hstage('Build Docker Image - Database') { [?25h[?25l[1;32r[1;1H[3M[1;33r[30;13Hsteps {[31;17Hdir(SQL_DIR) {[32;21Hsh "docker build --no-cache -t ${DOCKER_IMAG[?25h[?25lE_DB} ."[32;12H[?25h[?25l[1;32r[1;1H[5M[1;33r[28;17H}[29;13H}[30;9H}[32;9Hstage('Push Docker Image - Database') {[32;7H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17HwithCredentials([usernamePassword(credentialsId: 'DOC[?25h[?25lKER_HUB', usernameVariable: 'DOCKER_HU[32;1H[1m[34m@@@                                                                                                        [1;32r[m[32;1H
[1;33r[31;1H                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[32;1HB_USR', passwordVariable:[?25h[?25l 'DOCKER_HUB_PSW')]) {[32;14H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21Hsh """[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB[?25h[?25l_USR --password-stdin[32;42H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_DB}[32;8H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;21H"""[31;17H}[32;13H} [?25h[?25l[1;32r[1;1H[4M[1;33r[29;9H}[31;9Hstage('Build Docker Image - App') {[32;13Hsteps {[25C[?25h[?25l[1;32r[32;1H
[1;33r[32;17Hsh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."[32;10H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13H}[32;9H}[9C[?25h[?25l[1;32r[1;1H[3M[1;33r[31;9Hstage('Push Docker Image - App') {[32;13Hsteps {[42C[?25h[?25l[1;32r[32;1H
[1;33r[32;17HwithCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HU[32;1H[1m[34m@@@                                                                                                        [1;32r[m[32;1H
[1;33r[31;1H                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUU[32;1HB_USR', passwordV[?25h[?25lariable: 'DOCKER_HUB_PSW')]) {B_USR[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21Hsh """[32;25Hecho \$DOCKER_HUB_PSW | docker login -u \$DO[?25h[?25lCKER_HUB_USR --password-stdin[32;34H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hdocker push ${DOCKER_IMAGE_APP}[32;17H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21H"""[32;17H}[19C[?25h[?25l[1;32r[1;1H[4M[1;33r[29;13H}[30;9H}[32;9Hstage('Snyk Security Scan - Project Directory') {[32;22H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;13Hsteps {[32;17Hsh 'snyk code test . --severity-threshold=medium'[31;5H[?25h[?25l[1;32r[1;1H[3M[1;33r[30;13H}[31;9H}[1;32r[1;1H[2M[1;33r[31;9Hstage('Deploy to Kubernetes') {[32;13Hstep[?25h[?25ls {[40C[?25h[?25l[1;32r[32;1H
[1;33r[32;17HwithCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21Hsh """[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/ba[?25h[?25lnco-pv.yaml[32;52H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/create-db.yaml[32;39H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml[32;23H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml  [?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/depl[?25h[?25loy.yaml[32;56H[?25h[?25l[1;32r[32;1H
[1;33r[32;25Hmicrok8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml[32;18H[?25h[?25l[1;32r[1;1H[2M[1;33r[31;21H"""[32;17H}  [?25h[?25l[1;32r[1;1H[7M[1;33r[26;13H}[27;9H}
    }[30;5Hpost {[31;9Hsuccess {[32;13Hecho 'Deploy realizado com sucesso!'[1;32r[1;1H[2M[1;33r[31;9H}[32;7H[?25h[?25l  failure {   [?25h[?25l[33;1H[K[1;32r[1;1H[5M[1;33r[28;13Hecho 'A pipeline falhou!'[29;9H}
    }
}[33;90H103,0-1[7CBot[32;1H[?25h[?25l[33;80H^[[32;1H[33;80H  [32;1H[33;80H^[[32;1H[33;80H  [32;1H[?25h[?25l[33;80H:[32;1H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m"Jenkinsfile" 103L, 3367B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# cat Jenkinsfile 
[?2004lpipeline {
    agent any

    environment {
        DOCKER_REPO = 'k1cornelsenp/projeto-ecommerce'
        DOCKER_IMAGE_APP = "${DOCKER_REPO}:latest"
        DOCKER_IMAGE_DB = "${DOCKER_REPO}-db:latest"
        K8S_DIR = 'k8s/'
        SQL_DIR = 'sql/'
        SNYK_TOKEN = credentials('SNYK_AUTH')
        DOCKER_HUB = credentials('DOCKER_HUB')
    }

    stages {
        stage('Clone Repository') {
            steps {
                git 'https://github.com/k1cornelsen/projeto-ecommerce.git'
            }
        }

        stage('Snyk Docker Image Scan - App') {
            steps {
                sh """
                    snyk auth --auth-type=token $SNYK_TOKEN
                    snyk container test ${DOCKER_IMAGE_APP} --severity-threshold=medium
                """
            }
        }

        stage('Snyk Docker Image Scan - Database') {
            steps {
                sh "snyk container test ${DOCKER_IMAGE_DB} --severity-threshold=medium"
            }
        }

        stage('Build Docker Image - Database') {
            steps {
                dir(SQL_DIR) {
                    sh "docker build --no-cache -t ${DOCKER_IMAGE_DB} ."
                }
            }
        }

        stage('Push Docker Image - Database') {
            steps {
                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {
                    sh """
                        echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin
                        docker push ${DOCKER_IMAGE_DB}
                    """
                }
            }
        }

        stage('Build Docker Image - App') {
            steps {
                sh "docker build --no-cache -t ${DOCKER_IMAGE_APP} -f Dockerfile ."
            }
        }

        stage('Push Docker Image - App') {
            steps {
                withCredentials([usernamePassword(credentialsId: 'DOCKER_HUB', usernameVariable: 'DOCKER_HUB_USR', passwordVariable: 'DOCKER_HUB_PSW')]) {
                    sh """
                        echo \$DOCKER_HUB_PSW | docker login -u \$DOCKER_HUB_USR --password-stdin
                        docker push ${DOCKER_IMAGE_APP}
                    """
                }
            }
        }

        stage('Snyk Security Scan - Project Directory') {
            steps {
                sh 'snyk code test . --severity-threshold=medium'
            }
        }

        stage('Deploy to Kubernetes') {
            steps {
                withCredentials([file(credentialsId: 'kubeconfig', variable: 'KUBECONFIG')]) {
                    sh """
                        microk8s kubectl apply -f ${K8S_DIR}/banco-pv.yaml
                        microk8s kubectl apply -f ${K8S_DIR}/create-db.yaml
                        microk8s kubectl apply -f ${K8S_DIR}/deploy-banco.yaml
                        microk8s kubectl apply -f ${K8S_DIR}/deploy-svc-banco.yaml
                        microk8s kubectl apply -f ${K8S_DIR}/deploy.yaml
                        microk8s kubectl apply -f ${K8S_DIR}/deploy-svc.yaml
                    """
                }
            }
        }
    }

    post {
        success {
            echo 'Deploy realizado com sucesso!'
        }
        failure {
            echo 'A pipeline falhou!'
        }
    }
}

[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "Teste senha finalida[K[Kzado"
[?2004l[master c820418] Teste senha finalizado
 2 files changed, 11 insertions(+), 19 deletions(-)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git push origin master
[?2004lEnumerating objects: 7, done.
Counting objects:  14% (1/7)Counting objects:  28% (2/7)Counting objects:  42% (3/7)Counting objects:  57% (4/7)Counting objects:  71% (5/7)Counting objects:  85% (6/7)Counting objects: 100% (7/7)Counting objects: 100% (7/7), done.
Delta compression using up to 5 threads
Compressing objects:  25% (1/4)Compressing objects:  50% (2/4)Compressing objects:  75% (3/4)Compressing objects: 100% (4/4)Compressing objects: 100% (4/4), done.
Writing objects:  25% (1/4)Writing objects:  50% (2/4)Writing objects:  75% (3/4)Writing objects: 100% (4/4)Writing objects: 100% (4/4), 618 bytes | 618.00 KiB/s, done.
Total 4 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/3)[Kremote: Resolving deltas:  33% (1/3)[Kremote: Resolving deltas:  66% (2/3)[Kremote: Resolving deltas: 100% (3/3)[Kremote: Resolving deltas: 100% (3/3), completed with 3 local objects.[K
To https://github.com/k1cornelsen/projeto-ecommerce.git
   36e43c1..c820418  master -> master
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# cat Dockerfile 
[?2004lFROM php:8.1-apache

# Instala apenas as dependÃªncias essenciais para mysqli, sem bibliotecas adicionais com vulnerabilidades
RUN apt-get update && apt-get install -y \
    libmariadb-dev-compat \
    default-mysql-client \
    && docker-php-ext-install mysqli \
    && docker-php-ext-enable mysqli

# Remove bibliotecas que causam vulnerabilidades conhecidas
RUN apt-get remove -y \
    zlib1g-dev \
    libsqlite3-0 \
    libpam0g \
    libapr1 \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

# Copia o cÃ³digo da aplicaÃ§Ã£o para o diretÃ³rio padrÃ£o do Apache
COPY . /var/www/html/

# Ajusta permissÃµes para o Apache
RUN chown -R www-data:www-data /var/www/html \
    && chmod -R 755 /var/www/html

# ExpÃµe a porta 80 para o Apache
EXPOSE 80

[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# ls -la
[?2004ltotal 364
drwxrwxr-x 11 root root   4096 Nov 10 20:05  [0m[01;34m.[0m
drwxr-xr-x  3 root root   4096 Nov  9 20:55  [01;34m..[0m
-rw-r--r--  1 root root   2599 Nov 10 18:41  .dccache
drwxrwxr-x  8 root root   4096 Nov 10 20:06  [01;34m.git[0m
-rwxr-xr-x  1 root root    757 Nov 10 19:59  [01;32mDockerfile[0m
-rwxr-xr-x  1 root root   3367 Nov 10 20:05  [01;32mJenkinsfile[0m
-rwxr-xr-x  1 root root    203 Nov 10 18:39  [01;32mREADME.txt[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34massets[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34mcss[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34mindex[0m
drwxrwxr-x  2 root root   4096 Nov 10 18:39  [01;34mjs[0m
drwxrwxr-x  2 root root   4096 Nov 10 18:39  [01;34mk8s[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34mpages[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34mphp[0m
drwxr-xr-x  2 root root   4096 Nov 10 18:39  [01;34msql[0m
-rw-r--r--  1 root root 307200 Nov 10 20:05 '{'
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# vi .snyk
[?2004l[?1049h[22;0;0t[>4;2m[?1h=[?2004h[?1004h[1;33r[?12h[?12l[22;2t[22;1t[27m[23m[29m[m[H[2J[?25l[33;1H".snyk" [New][2;1Hâ–½[6n[2;1H  [3;1HPzz\[0%m[6n[3;1H           [1;1H[>c]10;?]11;?[2;1H[1m[34m~                                                                                                          [3;1H~                                                                                                          [4;1H~                                                                                                          [5;1H~                                                                                                          [6;1H~                                                                                                          [7;1H~                                                                                                          [8;1H~                                                                                                          [9;1H~                                                                                                          [10;1H~                                                                                                          [11;1H~                                                                                                          [12;1H~                                                                                                          [13;1H~                                                                                                          [14;1H~                                                                                                          [15;1H~                                                                                                          [16;1H~                                                                                                          [17;1H~                                                                                                          [18;1H~                                                                                                          [19;1H~                                                                                                          [20;1H~                                                                                                          [21;1H~                                                                                                          [22;1H~                                                                                                          [23;1H~                                                                                                          [24;1H~                                                                                                          [25;1H~                                                                                                          [26;1H~                                                                                                          [27;1H~                                                                                                          [28;1H~                                                                                                          [29;1H~                                                                                                          [30;1H~                                                                                                          [31;1H~                                                                                                          [32;1H~                                                                                                          [m[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hversion: v1.5.0
ignore:[2;8H[K[3;1H    'SNYK-JS-INFLIGHT-6095116':[3;32H[K[4;1H[K[4;1H[?25h[?25l     - '*':
        reason: 'No fix available'[5;35H[K[6;1H        expires[6;16H[K[6;16H[?25h[?25l[33;1H[K[6;16H: '2028-01-01T00:00:00.000Z'[33;90H6,43[10CAll[6;43H[?25h[?25l[33;80Hd[6;43H[?25h[?25l[33;81Hd[6;43H[33;80H  [5;9H
[1m[34m~                                                                                                          [m[33;90H5,9 [5;9H[?25h[?25l[33;80Hd[5;9H[?25h[?25l[33;81Hd[5;9H[33;80H  [4;6H
[1m[34m~                                                                                                          [m[33;90H4,6[4;6H[?25h[?25l[33;80Hd[4;6H[?25h[?25l[33;81Hd[4;6H[33;80H  [3;5H
[1m[34m~                                                                                                          [m[33;90H3,5[3;5H[?25h[?25l[33;80Hd[3;5H[?25h[?25l[33;81Hd[3;5H[33;80H  [2;1H
[1m[34m~                                                                                                          [m[33;90H2,1[2;1H[?25h[?25l[33;80Hd[2;1H[?25h[?25l[33;81Hd[2;1H[33;80H  [1;1H
[1m[34m~                                                                                                          [m[33;90H1[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[1;1H[K[33;1H--No lines in buffer--[33;90H[K[33;90H0,0-1[9CAll[1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;80Hd[1;1H[?25h[?25l[33;81Hd[1;1H[33;80H  [1;1H[?25h[?25l[33;1H[1m-- INSERT --[m[33;13H[K[33;90H0,1[11CAll[1;1Hversion: v1.18.0
ignore:[2;8H[K[3;1H  SNYK-DEBIAN12-APR-7833616:[3;29H[K[4;1H    - "[4;8H[K[4;8H[?25h[?25l*":
        reason: "Vulnerabilidade removida da imagem ao ajustar[5;63H[K[5;63H[?25h[?25l o Dockerfile."
        expires: "2025-01-01T00:00:00Z"[6;40H[K[7;1H  SNYK-DE[7;10H[K[7;10H[?25h[?25lBIAN12-SQLITE3-6139924:
    - "*":[8;11H[K[9;1H        reason: "Vulnerabilid[9;30H[K[9;30H[?25h[?25lade removida da imagem ao ajustar o Dockerfile."
        expires[10;16H[K[10;16H[?25h[?25l: "2025-01-01T00:00:00Z"
  SNYK-DEBIAN12-PAM-8352887:[11;29H[K[12;1H    - "*"[12;10H[K[12;10H[?25h[?25l:
        reason: "Vulnerabilidade removida da imagem ao ajusta[13;62H[K[13;62H[?25h[?25lr o Dockerfile."
        expires: "2025-01-01T00:00:00Z"[14;40H[K[15;1H  SNYK[15;7H[K[15;7H[?25h[?25l-DEBIAN12-ZLIB-6008963:
    - "*":[16;11H[K[17;1H        reason: "Vulnerabili[17;29H[K[17;29H[?25h[?25ldade removida da imagem ao ajustar o Dockerfile."
        expir[18;14H[K[18;14H[?25h[?25l[33;1H[K[18;14Hes: "2025-01-01T00:00:00Z"[19;1H[K[33;90H19,0-1[8CAll[19;1H[?25h[?25l[33;80H^[[19;1H[33;80H  [19;1H[33;80H^[[19;1H[33;80H  [19;1H[?25h[?25l[33;80H:[19;1H[33;80H[K[33;1H:[?25hwq[?25l[?2004l[>4;m".snyk" [New] 19L, 663B written[23;2t[23;1t
[?1004l[?2004l[?1l>[?25h[>4;m[?1049l[23;0;0t[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git commit -a -m "correcao snyk"
[?2004lOn branch master
Your branch is up to date with 'origin/master'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	[31m.dccache[m
	[31m.snyk[m
	[31mjs/.dccache[m
	[31mk8s/banco-pvc.yaml[m
	[31m{[m

nothing added to commit but untracked files present (use "git add" to track)
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# git push origin master
[?2004lEverything up-to-date
[?2004h]0;root@devsecops: /var/www/html/projeto-ecommerceroot@devsecops:/var/www/html/projeto-ecommerce# ls -la
[?2004ltotal 376
drwxrwxr-x 11 root root   4096 Nov 10 20:10  [0m[01;34m.[0m
drwxr-xr-x  3 root root   4096 Nov  9 20:55  [01;34m..[0m
-rw-r--r--  1 root root   2599 Nov 10 18:41  .dccache
drwxrwxr-x  8 root root   